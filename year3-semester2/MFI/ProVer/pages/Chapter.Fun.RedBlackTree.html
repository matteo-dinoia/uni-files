<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Red black trees | Introduction to Program Verification in Agda</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="Red black trees" />
<meta property="og:locale" content="en_US" />
<meta property="og:site_name" content="Introduction to Program Verification in Agda" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Red black trees" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","headline":"Red black trees","url":"/pages/Chapter.Fun.RedBlackTree.html"}</script>
<!-- End Jekyll SEO tag -->

  <link rel="stylesheet" href="../assets/css/main.css">
  <link rel="stylesheet" href="../assets/css/Agda.css">
  <script src="../assets/js/mathjax.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="../assets/js/codereveal.js"></script>
  <link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Introduction to Program Verification in Agda" /><!-- <script src="/assets/js/clipboard.min.js"></script> -->
  <!-- <script src="/assets/js/codeselect.js"></script> -->
</head>
<body>

<header class="site-header" role="banner">
  <div class="wrapper">
    <a class="site-title" rel="author" href="../index.html">Introduction to Program Verification in Agda</a>
    

    <nav class="site-nav">
      <a href="https://agda.readthedocs.io/en/latest/">AGDA DOCS</a>
    </nav>
  </div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">
  <ul class="menu">
  <li><a href="Main.html">‹ Table of contents</a></li>
  <li><a href="Main.html">Table of contents ›</a></li>
</ul>
  <header class="post-header">
    <h1 class="post-title">Red black trees</h1>
  </header>

  <div class="post-content">
    <p>A red black tree is a binary search tree in which nodes are colored
(either red or black) and the following conditions are enforced:</p>

<ol>
  <li>Every red node only has red children.</li>
  <li>Every path from the root to one of the leaves goes through the
number of black nodes.</li>
</ol>

<p>The combination of these properties makes sure that the depth of a red black tree cannot be more than twice the length of the shortest path from its root to one of its leaves. So, a red black tree is reasonably balanced.</p>

<pre class="Agda"><a id="531" class="Keyword">module</a> <a id="538" href="Chapter.Fun.RedBlackTree.html" class="Module">Chapter.Fun.RedBlackTree</a> <a id="563" class="Symbol">(</a><a id="564" href="Chapter.Fun.RedBlackTree.html#564" class="Bound">A</a> <a id="566" class="Symbol">:</a> <a id="568" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="571" class="Symbol">)</a> <a id="573" class="Symbol">(</a><a id="574" href="Chapter.Fun.RedBlackTree.html#574" class="Bound Operator">_≼_</a> <a id="578" class="Symbol">:</a> <a id="580" href="Chapter.Fun.RedBlackTree.html#564" class="Bound">A</a> <a id="582" class="Symbol">-&gt;</a> <a id="585" href="Chapter.Fun.RedBlackTree.html#564" class="Bound">A</a> <a id="587" class="Symbol">-&gt;</a> <a id="590" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="593" class="Symbol">)</a> <a id="595" class="Keyword">where</a>

<a id="602" class="Keyword">open</a> <a id="607" class="Keyword">import</a> <a id="614" href="Library.Nat.html" class="Module">Library.Nat</a>
<a id="626" class="Keyword">open</a> <a id="631" class="Keyword">import</a> <a id="638" href="Library.Nat.Properties.html" class="Module">Library.Nat.Properties</a>
<a id="661" class="Keyword">open</a> <a id="666" class="Keyword">import</a> <a id="673" href="Library.Logic.html" class="Module">Library.Logic</a>
<a id="687" class="Keyword">open</a> <a id="692" class="Keyword">import</a> <a id="699" href="Library.LessThan.html" class="Module">Library.LessThan</a>
<a id="716" class="Keyword">open</a> <a id="721" class="Keyword">import</a> <a id="728" href="Library.LessThan.Reasoning.html" class="Module">Library.LessThan.Reasoning</a>
<a id="755" class="Keyword">open</a> <a id="760" class="Keyword">import</a> <a id="767" href="Library.Equality.html" class="Module">Library.Equality</a>

<a id="785" class="Keyword">data</a> <a id="Order"></a><a id="790" href="Chapter.Fun.RedBlackTree.html#790" class="Datatype">Order</a> <a id="796" class="Symbol">:</a> <a id="798" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="802" class="Keyword">where</a>
  <a id="Order.LT"></a><a id="810" href="Chapter.Fun.RedBlackTree.html#810" class="InductiveConstructor">LT</a> <a id="Order.EQ"></a><a id="813" href="Chapter.Fun.RedBlackTree.html#813" class="InductiveConstructor">EQ</a> <a id="Order.GT"></a><a id="816" href="Chapter.Fun.RedBlackTree.html#816" class="InductiveConstructor">GT</a> <a id="819" class="Symbol">:</a> <a id="821" href="Chapter.Fun.RedBlackTree.html#790" class="Datatype">Order</a>

<a id="828" class="Keyword">postulate</a> <a id="compare"></a><a id="838" href="Chapter.Fun.RedBlackTree.html#838" class="Postulate">compare</a> <a id="846" class="Symbol">:</a> <a id="848" href="Chapter.Fun.RedBlackTree.html#564" class="Bound">A</a> <a id="850" class="Symbol">-&gt;</a> <a id="853" href="Chapter.Fun.RedBlackTree.html#564" class="Bound">A</a> <a id="855" class="Symbol">-&gt;</a> <a id="858" href="Chapter.Fun.RedBlackTree.html#790" class="Datatype">Order</a>
</pre>
<p>We represent a red black tree using three distinct data types,
<code class="language-plaintext highlighter-rouge">RedTree</code>, <code class="language-plaintext highlighter-rouge">BlackTree</code> and <code class="language-plaintext highlighter-rouge">RedBlackTree</code>. As suggested by their
names, the root of a <code class="language-plaintext highlighter-rouge">RedTree</code> is certainly red, the root of a
<code class="language-plaintext highlighter-rouge">BlackTree</code> is certainly black, whereas the root of a <code class="language-plaintext highlighter-rouge">RedBlackTree</code>
can be either red or black. By devising distinct data types, we can
enforce the property (1) of red black trees requiring that the
children of a red-rooted tree must be black, as opposed to the
children of a black-rooted tree that can be either red or black. In
addition, we index these data types with a natural number called
<strong>black height</strong>. Intuitively, the black height of a tree is the
number of inner black nodes along the paths from the root to its
leaves. By making sure that the children of a tree have the same
black height, we enforce the property (2) of red black trees.</p>

<p>Clearly, these data types are mutually dependent on each other. For
this reason, we cannot simply define them one after the other in an
Agda script. Rather, we must separate their <em>declaration</em> from their
<em>definition</em> so that all of them have been declared by the time they
are defined.</p>

<p>A data type declaration starts like a data type definition, but the
<code class="language-plaintext highlighter-rouge">where</code> keyword is omitted and no costructor is given:</p>

<pre class="Agda"><a id="2134" class="Keyword">data</a> <a id="RedTree"></a><a id="2139" href="Chapter.Fun.RedBlackTree.html#2139" class="Datatype">RedTree</a> <a id="2147" class="Symbol">:</a> <a id="2149" href="Library.Nat.html#32" class="Datatype">ℕ</a> <a id="2151" class="Symbol">-&gt;</a> <a id="2154" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="2158" class="Keyword">data</a> <a id="BlackTree"></a><a id="2163" href="Chapter.Fun.RedBlackTree.html#2163" class="Datatype">BlackTree</a> <a id="2173" class="Symbol">:</a> <a id="2175" href="Library.Nat.html#32" class="Datatype">ℕ</a> <a id="2177" class="Symbol">-&gt;</a> <a id="2180" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="2184" class="Keyword">data</a> <a id="RedBlackTree"></a><a id="2189" href="Chapter.Fun.RedBlackTree.html#2189" class="Datatype">RedBlackTree</a> <a id="2202" class="Symbol">:</a> <a id="2204" href="Library.Nat.html#32" class="Datatype">ℕ</a> <a id="2206" class="Symbol">-&gt;</a> <a id="2209" href="Agda.Primitive.html#326" class="Primitive">Set</a>
</pre>
<p>These statements make Agda aware of the fact that from now on we may
refer to these data types, even though we haven’t defined their
constructors yet. To do so, we now provide further <code class="language-plaintext highlighter-rouge">data</code>
definitions, this time omitting the type signature of the data type
being defined but listing their constructors. In particular, a
<code class="language-plaintext highlighter-rouge">RedTree</code> with black height <code class="language-plaintext highlighter-rouge">n</code> is necessarily an inner <code class="language-plaintext highlighter-rouge">node</code>
(leaves are black by convention) and its children are necessarily
black-rooted trees with black height <code class="language-plaintext highlighter-rouge">n</code>.</p>

<pre class="Agda"><a id="2720" class="Keyword">data</a> <a id="2725" href="Chapter.Fun.RedBlackTree.html#2139" class="Datatype">RedTree</a> <a id="2733" class="Keyword">where</a>
  <a id="RedTree.node"></a><a id="2741" href="Chapter.Fun.RedBlackTree.html#2741" class="InductiveConstructor">node</a> <a id="2746" class="Symbol">:</a> <a id="2748" class="Symbol">{</a><a id="2749" href="Chapter.Fun.RedBlackTree.html#2749" class="Bound">n</a> <a id="2751" class="Symbol">:</a> <a id="2753" href="Library.Nat.html#32" class="Datatype">ℕ</a><a id="2754" class="Symbol">}</a> <a id="2756" class="Symbol">-&gt;</a> <a id="2759" href="Chapter.Fun.RedBlackTree.html#564" class="Bound">A</a> <a id="2761" class="Symbol">-&gt;</a> <a id="2764" href="Chapter.Fun.RedBlackTree.html#2163" class="Datatype">BlackTree</a> <a id="2774" href="Chapter.Fun.RedBlackTree.html#2749" class="Bound">n</a> <a id="2776" class="Symbol">-&gt;</a> <a id="2779" href="Chapter.Fun.RedBlackTree.html#2163" class="Datatype">BlackTree</a> <a id="2789" href="Chapter.Fun.RedBlackTree.html#2749" class="Bound">n</a> <a id="2791" class="Symbol">-&gt;</a> <a id="2794" href="Chapter.Fun.RedBlackTree.html#2139" class="Datatype">RedTree</a> <a id="2802" href="Chapter.Fun.RedBlackTree.html#2749" class="Bound">n</a>
</pre>
<p>A <code class="language-plaintext highlighter-rouge">BlackTree</code> is either a <code class="language-plaintext highlighter-rouge">leaf</code> (which has black height 0) or an
inner <code class="language-plaintext highlighter-rouge">node</code>, whose black height is one plus that of its two
children. The children of a black node are red black trees, so their
roots can be either red or black (and need not be of the same
color).</p>

<pre class="Agda"><a id="3084" class="Keyword">data</a> <a id="3089" href="Chapter.Fun.RedBlackTree.html#2163" class="Datatype">BlackTree</a> <a id="3099" class="Keyword">where</a>
  <a id="BlackTree.leaf"></a><a id="3107" href="Chapter.Fun.RedBlackTree.html#3107" class="InductiveConstructor">leaf</a> <a id="3112" class="Symbol">:</a> <a id="3114" href="Chapter.Fun.RedBlackTree.html#2163" class="Datatype">BlackTree</a> <a id="3124" class="Number">0</a>
  <a id="BlackTree.node"></a><a id="3128" href="Chapter.Fun.RedBlackTree.html#3128" class="InductiveConstructor">node</a> <a id="3133" class="Symbol">:</a> <a id="3135" class="Symbol">{</a><a id="3136" href="Chapter.Fun.RedBlackTree.html#3136" class="Bound">n</a> <a id="3138" class="Symbol">:</a> <a id="3140" href="Library.Nat.html#32" class="Datatype">ℕ</a><a id="3141" class="Symbol">}</a> <a id="3143" class="Symbol">-&gt;</a> <a id="3146" href="Chapter.Fun.RedBlackTree.html#564" class="Bound">A</a> <a id="3148" class="Symbol">-&gt;</a> <a id="3151" href="Chapter.Fun.RedBlackTree.html#2189" class="Datatype">RedBlackTree</a> <a id="3164" href="Chapter.Fun.RedBlackTree.html#3136" class="Bound">n</a> <a id="3166" class="Symbol">-&gt;</a> <a id="3169" href="Chapter.Fun.RedBlackTree.html#2189" class="Datatype">RedBlackTree</a> <a id="3182" href="Chapter.Fun.RedBlackTree.html#3136" class="Bound">n</a> <a id="3184" class="Symbol">-&gt;</a> <a id="3187" href="Chapter.Fun.RedBlackTree.html#2163" class="Datatype">BlackTree</a> <a id="3197" class="Symbol">(</a><a id="3198" href="Library.Nat.html#59" class="InductiveConstructor">succ</a> <a id="3203" href="Chapter.Fun.RedBlackTree.html#3136" class="Bound">n</a><a id="3204" class="Symbol">)</a>
</pre>
<p>Finally, a <code class="language-plaintext highlighter-rouge">RedBlackTree</code> with black height <code class="language-plaintext highlighter-rouge">n</code> is either a red tree
or a black tree with the same black height.</p>

<pre class="Agda"><a id="3333" class="Keyword">data</a> <a id="3338" href="Chapter.Fun.RedBlackTree.html#2189" class="Datatype">RedBlackTree</a> <a id="3351" class="Keyword">where</a>
  <a id="RedBlackTree.red"></a><a id="3359" href="Chapter.Fun.RedBlackTree.html#3359" class="InductiveConstructor">red</a>   <a id="3365" class="Symbol">:</a> <a id="3367" class="Symbol">{</a><a id="3368" href="Chapter.Fun.RedBlackTree.html#3368" class="Bound">n</a> <a id="3370" class="Symbol">:</a> <a id="3372" href="Library.Nat.html#32" class="Datatype">ℕ</a><a id="3373" class="Symbol">}</a> <a id="3375" class="Symbol">-&gt;</a> <a id="3378" href="Chapter.Fun.RedBlackTree.html#2139" class="Datatype">RedTree</a> <a id="3386" href="Chapter.Fun.RedBlackTree.html#3368" class="Bound">n</a> <a id="3388" class="Symbol">-&gt;</a> <a id="3391" href="Chapter.Fun.RedBlackTree.html#2189" class="Datatype">RedBlackTree</a> <a id="3404" href="Chapter.Fun.RedBlackTree.html#3368" class="Bound">n</a>
  <a id="RedBlackTree.black"></a><a id="3408" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="3414" class="Symbol">:</a> <a id="3416" class="Symbol">{</a><a id="3417" href="Chapter.Fun.RedBlackTree.html#3417" class="Bound">n</a> <a id="3419" class="Symbol">:</a> <a id="3421" href="Library.Nat.html#32" class="Datatype">ℕ</a><a id="3422" class="Symbol">}</a> <a id="3424" class="Symbol">-&gt;</a> <a id="3427" href="Chapter.Fun.RedBlackTree.html#2163" class="Datatype">BlackTree</a> <a id="3437" href="Chapter.Fun.RedBlackTree.html#3417" class="Bound">n</a> <a id="3439" class="Symbol">-&gt;</a> <a id="3442" href="Chapter.Fun.RedBlackTree.html#2189" class="Datatype">RedBlackTree</a> <a id="3455" href="Chapter.Fun.RedBlackTree.html#3417" class="Bound">n</a>
</pre>
<p>When we insert an element into a red black tree there can be a
moment in which the tree is temporarily unbalanced, in the sense
that it violates condition (1) above. To accommodate the
intermediate form we also introduce yet another data type, called
<code class="language-plaintext highlighter-rouge">SomeTree</code>, which is either a plain red black tree or a red-rooted
tree in which one of its children is black but the other is red Note
that we distinguish between a “left” unbalanced tree (constructor
<code class="language-plaintext highlighter-rouge">red-l</code>) from a “right” unbalanced tree (constructor <code class="language-plaintext highlighter-rouge">red-r</code>).</p>

<pre class="Agda"><a id="3987" class="Keyword">data</a> <a id="SomeTree"></a><a id="3992" href="Chapter.Fun.RedBlackTree.html#3992" class="Datatype">SomeTree</a> <a id="4001" class="Symbol">:</a> <a id="4003" href="Library.Nat.html#32" class="Datatype">ℕ</a> <a id="4005" class="Symbol">-&gt;</a> <a id="4008" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="4012" class="Keyword">where</a>
  <a id="SomeTree.plain"></a><a id="4020" href="Chapter.Fun.RedBlackTree.html#4020" class="InductiveConstructor">plain</a> <a id="4026" class="Symbol">:</a> <a id="4028" class="Symbol">{</a><a id="4029" href="Chapter.Fun.RedBlackTree.html#4029" class="Bound">n</a> <a id="4031" class="Symbol">:</a> <a id="4033" href="Library.Nat.html#32" class="Datatype">ℕ</a><a id="4034" class="Symbol">}</a> <a id="4036" class="Symbol">-&gt;</a> <a id="4039" href="Chapter.Fun.RedBlackTree.html#2189" class="Datatype">RedBlackTree</a> <a id="4052" href="Chapter.Fun.RedBlackTree.html#4029" class="Bound">n</a> <a id="4054" class="Symbol">-&gt;</a> <a id="4057" href="Chapter.Fun.RedBlackTree.html#3992" class="Datatype">SomeTree</a> <a id="4066" href="Chapter.Fun.RedBlackTree.html#4029" class="Bound">n</a>
  <a id="SomeTree.red-l"></a><a id="4070" href="Chapter.Fun.RedBlackTree.html#4070" class="InductiveConstructor">red-l</a> <a id="4076" class="Symbol">:</a> <a id="4078" class="Symbol">{</a><a id="4079" href="Chapter.Fun.RedBlackTree.html#4079" class="Bound">n</a> <a id="4081" class="Symbol">:</a> <a id="4083" href="Library.Nat.html#32" class="Datatype">ℕ</a><a id="4084" class="Symbol">}</a> <a id="4086" class="Symbol">-&gt;</a> <a id="4089" href="Chapter.Fun.RedBlackTree.html#564" class="Bound">A</a> <a id="4091" class="Symbol">-&gt;</a> <a id="4094" href="Chapter.Fun.RedBlackTree.html#2139" class="Datatype">RedTree</a> <a id="4102" href="Chapter.Fun.RedBlackTree.html#4079" class="Bound">n</a> <a id="4104" class="Symbol">-&gt;</a> <a id="4107" href="Chapter.Fun.RedBlackTree.html#2163" class="Datatype">BlackTree</a> <a id="4117" href="Chapter.Fun.RedBlackTree.html#4079" class="Bound">n</a> <a id="4119" class="Symbol">-&gt;</a> <a id="4122" href="Chapter.Fun.RedBlackTree.html#3992" class="Datatype">SomeTree</a> <a id="4131" href="Chapter.Fun.RedBlackTree.html#4079" class="Bound">n</a>
  <a id="SomeTree.red-r"></a><a id="4135" href="Chapter.Fun.RedBlackTree.html#4135" class="InductiveConstructor">red-r</a> <a id="4141" class="Symbol">:</a> <a id="4143" class="Symbol">{</a><a id="4144" href="Chapter.Fun.RedBlackTree.html#4144" class="Bound">n</a> <a id="4146" class="Symbol">:</a> <a id="4148" href="Library.Nat.html#32" class="Datatype">ℕ</a><a id="4149" class="Symbol">}</a> <a id="4151" class="Symbol">-&gt;</a> <a id="4154" href="Chapter.Fun.RedBlackTree.html#564" class="Bound">A</a> <a id="4156" class="Symbol">-&gt;</a> <a id="4159" href="Chapter.Fun.RedBlackTree.html#2163" class="Datatype">BlackTree</a> <a id="4169" href="Chapter.Fun.RedBlackTree.html#4144" class="Bound">n</a> <a id="4171" class="Symbol">-&gt;</a> <a id="4174" href="Chapter.Fun.RedBlackTree.html#2139" class="Datatype">RedTree</a> <a id="4182" href="Chapter.Fun.RedBlackTree.html#4144" class="Bound">n</a> <a id="4184" class="Symbol">-&gt;</a> <a id="4187" href="Chapter.Fun.RedBlackTree.html#3992" class="Datatype">SomeTree</a> <a id="4196" href="Chapter.Fun.RedBlackTree.html#4144" class="Bound">n</a>
</pre>
<p>The next two functions implement a <em>balancing</em> operation. In
particular, <code class="language-plaintext highlighter-rouge">balance-l x l r</code> balances a hypothetical black-rooted
tree having <code class="language-plaintext highlighter-rouge">x</code> in its root, a possibly unbalanced left child <code class="language-plaintext highlighter-rouge">l</code>
and a balanced right child <code class="language-plaintext highlighter-rouge">r</code>. The function <code class="language-plaintext highlighter-rouge">balance-r x l r</code> does
the same for a tree in which the right child is possibly
unbalanced. The balancing operation is achieved by performing a
suitable rotation of the tree structure while preserving the
ordering between the elements in the tree. The re-balanced tree
turns out to have the same black height of the (hypothetical)
unbalanced one.</p>

<pre class="Agda"><a id="balance-l"></a><a id="4798" href="Chapter.Fun.RedBlackTree.html#4798" class="Function">balance-l</a> <a id="4808" class="Symbol">:</a> <a id="4810" class="Symbol">{</a><a id="4811" href="Chapter.Fun.RedBlackTree.html#4811" class="Bound">n</a> <a id="4813" class="Symbol">:</a> <a id="4815" href="Library.Nat.html#32" class="Datatype">ℕ</a><a id="4816" class="Symbol">}</a> <a id="4818" class="Symbol">-&gt;</a> <a id="4821" href="Chapter.Fun.RedBlackTree.html#564" class="Bound">A</a> <a id="4823" class="Symbol">-&gt;</a> <a id="4826" href="Chapter.Fun.RedBlackTree.html#3992" class="Datatype">SomeTree</a> <a id="4835" href="Chapter.Fun.RedBlackTree.html#4811" class="Bound">n</a> <a id="4837" class="Symbol">-&gt;</a> <a id="4840" href="Chapter.Fun.RedBlackTree.html#2189" class="Datatype">RedBlackTree</a> <a id="4853" href="Chapter.Fun.RedBlackTree.html#4811" class="Bound">n</a> <a id="4855" class="Symbol">-&gt;</a> <a id="4858" href="Chapter.Fun.RedBlackTree.html#2189" class="Datatype">RedBlackTree</a> <a id="4871" class="Symbol">(</a><a id="4872" href="Library.Nat.html#59" class="InductiveConstructor">succ</a> <a id="4877" href="Chapter.Fun.RedBlackTree.html#4811" class="Bound">n</a><a id="4878" class="Symbol">)</a>
<a id="4880" href="Chapter.Fun.RedBlackTree.html#4798" class="Function">balance-l</a> <a id="4890" href="Chapter.Fun.RedBlackTree.html#4890" class="Bound">z</a> <a id="4892" class="Symbol">(</a><a id="4893" href="Chapter.Fun.RedBlackTree.html#4020" class="InductiveConstructor">plain</a> <a id="4899" href="Chapter.Fun.RedBlackTree.html#4899" class="Bound">l</a><a id="4900" class="Symbol">)</a> <a id="4902" href="Chapter.Fun.RedBlackTree.html#4902" class="Bound">r</a> <a id="4904" class="Symbol">=</a> <a id="4906" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="4912" class="Symbol">(</a><a id="4913" href="Chapter.Fun.RedBlackTree.html#3128" class="InductiveConstructor">node</a> <a id="4918" href="Chapter.Fun.RedBlackTree.html#4890" class="Bound">z</a> <a id="4920" href="Chapter.Fun.RedBlackTree.html#4899" class="Bound">l</a> <a id="4922" href="Chapter.Fun.RedBlackTree.html#4902" class="Bound">r</a><a id="4923" class="Symbol">)</a>
<a id="4925" href="Chapter.Fun.RedBlackTree.html#4798" class="Function">balance-l</a> <a id="4935" href="Chapter.Fun.RedBlackTree.html#4935" class="Bound">z</a> <a id="4937" class="Symbol">(</a><a id="4938" href="Chapter.Fun.RedBlackTree.html#4070" class="InductiveConstructor">red-l</a> <a id="4944" href="Chapter.Fun.RedBlackTree.html#4944" class="Bound">y</a> <a id="4946" class="Symbol">(</a><a id="4947" href="Chapter.Fun.RedBlackTree.html#2741" class="InductiveConstructor">node</a> <a id="4952" href="Chapter.Fun.RedBlackTree.html#4952" class="Bound">x</a> <a id="4954" href="Chapter.Fun.RedBlackTree.html#4954" class="Bound">a</a> <a id="4956" href="Chapter.Fun.RedBlackTree.html#4956" class="Bound">b</a><a id="4957" class="Symbol">)</a> <a id="4959" href="Chapter.Fun.RedBlackTree.html#4959" class="Bound">c</a><a id="4960" class="Symbol">)</a> <a id="4962" href="Chapter.Fun.RedBlackTree.html#4962" class="Bound">d</a> <a id="4964" class="Symbol">=</a>
  <a id="4968" href="Chapter.Fun.RedBlackTree.html#3359" class="InductiveConstructor">red</a> <a id="4972" class="Symbol">(</a><a id="4973" href="Chapter.Fun.RedBlackTree.html#2741" class="InductiveConstructor">node</a> <a id="4978" href="Chapter.Fun.RedBlackTree.html#4944" class="Bound">y</a> <a id="4980" class="Symbol">(</a><a id="4981" href="Chapter.Fun.RedBlackTree.html#3128" class="InductiveConstructor">node</a> <a id="4986" href="Chapter.Fun.RedBlackTree.html#4952" class="Bound">x</a> <a id="4988" class="Symbol">(</a><a id="4989" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="4995" href="Chapter.Fun.RedBlackTree.html#4954" class="Bound">a</a><a id="4996" class="Symbol">)</a> <a id="4998" class="Symbol">(</a><a id="4999" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="5005" href="Chapter.Fun.RedBlackTree.html#4956" class="Bound">b</a><a id="5006" class="Symbol">))</a> <a id="5009" class="Symbol">(</a><a id="5010" href="Chapter.Fun.RedBlackTree.html#3128" class="InductiveConstructor">node</a> <a id="5015" href="Chapter.Fun.RedBlackTree.html#4935" class="Bound">z</a> <a id="5017" class="Symbol">(</a><a id="5018" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="5024" href="Chapter.Fun.RedBlackTree.html#4959" class="Bound">c</a><a id="5025" class="Symbol">)</a> <a id="5027" href="Chapter.Fun.RedBlackTree.html#4962" class="Bound">d</a><a id="5028" class="Symbol">))</a>
<a id="5031" href="Chapter.Fun.RedBlackTree.html#4798" class="Function">balance-l</a> <a id="5041" href="Chapter.Fun.RedBlackTree.html#5041" class="Bound">z</a> <a id="5043" class="Symbol">(</a><a id="5044" href="Chapter.Fun.RedBlackTree.html#4135" class="InductiveConstructor">red-r</a> <a id="5050" href="Chapter.Fun.RedBlackTree.html#5050" class="Bound">y</a> <a id="5052" href="Chapter.Fun.RedBlackTree.html#5052" class="Bound">a</a> <a id="5054" class="Symbol">(</a><a id="5055" href="Chapter.Fun.RedBlackTree.html#2741" class="InductiveConstructor">node</a> <a id="5060" href="Chapter.Fun.RedBlackTree.html#5060" class="Bound">x</a> <a id="5062" href="Chapter.Fun.RedBlackTree.html#5062" class="Bound">b</a> <a id="5064" href="Chapter.Fun.RedBlackTree.html#5064" class="Bound">c</a><a id="5065" class="Symbol">))</a> <a id="5068" href="Chapter.Fun.RedBlackTree.html#5068" class="Bound">d</a> <a id="5070" class="Symbol">=</a>
  <a id="5074" href="Chapter.Fun.RedBlackTree.html#3359" class="InductiveConstructor">red</a> <a id="5078" class="Symbol">(</a><a id="5079" href="Chapter.Fun.RedBlackTree.html#2741" class="InductiveConstructor">node</a> <a id="5084" href="Chapter.Fun.RedBlackTree.html#5060" class="Bound">x</a> <a id="5086" class="Symbol">(</a><a id="5087" href="Chapter.Fun.RedBlackTree.html#3128" class="InductiveConstructor">node</a> <a id="5092" href="Chapter.Fun.RedBlackTree.html#5050" class="Bound">y</a> <a id="5094" class="Symbol">(</a><a id="5095" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="5101" href="Chapter.Fun.RedBlackTree.html#5052" class="Bound">a</a><a id="5102" class="Symbol">)</a> <a id="5104" class="Symbol">(</a><a id="5105" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="5111" href="Chapter.Fun.RedBlackTree.html#5062" class="Bound">b</a><a id="5112" class="Symbol">))</a> <a id="5115" class="Symbol">(</a><a id="5116" href="Chapter.Fun.RedBlackTree.html#3128" class="InductiveConstructor">node</a> <a id="5121" href="Chapter.Fun.RedBlackTree.html#5041" class="Bound">z</a> <a id="5123" class="Symbol">(</a><a id="5124" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="5130" href="Chapter.Fun.RedBlackTree.html#5064" class="Bound">c</a><a id="5131" class="Symbol">)</a> <a id="5133" href="Chapter.Fun.RedBlackTree.html#5068" class="Bound">d</a><a id="5134" class="Symbol">))</a>

<a id="balance-r"></a><a id="5138" href="Chapter.Fun.RedBlackTree.html#5138" class="Function">balance-r</a> <a id="5148" class="Symbol">:</a> <a id="5150" class="Symbol">{</a><a id="5151" href="Chapter.Fun.RedBlackTree.html#5151" class="Bound">n</a> <a id="5153" class="Symbol">:</a> <a id="5155" href="Library.Nat.html#32" class="Datatype">ℕ</a><a id="5156" class="Symbol">}</a> <a id="5158" class="Symbol">-&gt;</a> <a id="5161" href="Chapter.Fun.RedBlackTree.html#564" class="Bound">A</a> <a id="5163" class="Symbol">-&gt;</a> <a id="5166" href="Chapter.Fun.RedBlackTree.html#2189" class="Datatype">RedBlackTree</a> <a id="5179" href="Chapter.Fun.RedBlackTree.html#5151" class="Bound">n</a> <a id="5181" class="Symbol">-&gt;</a> <a id="5184" href="Chapter.Fun.RedBlackTree.html#3992" class="Datatype">SomeTree</a> <a id="5193" href="Chapter.Fun.RedBlackTree.html#5151" class="Bound">n</a> <a id="5195" class="Symbol">-&gt;</a> <a id="5198" href="Chapter.Fun.RedBlackTree.html#2189" class="Datatype">RedBlackTree</a> <a id="5211" class="Symbol">(</a><a id="5212" href="Library.Nat.html#59" class="InductiveConstructor">succ</a> <a id="5217" href="Chapter.Fun.RedBlackTree.html#5151" class="Bound">n</a><a id="5218" class="Symbol">)</a>
<a id="5220" href="Chapter.Fun.RedBlackTree.html#5138" class="Function">balance-r</a> <a id="5230" href="Chapter.Fun.RedBlackTree.html#5230" class="Bound">z</a> <a id="5232" href="Chapter.Fun.RedBlackTree.html#5232" class="Bound">a</a> <a id="5234" class="Symbol">(</a><a id="5235" href="Chapter.Fun.RedBlackTree.html#4020" class="InductiveConstructor">plain</a> <a id="5241" href="Chapter.Fun.RedBlackTree.html#5241" class="Bound">b</a><a id="5242" class="Symbol">)</a> <a id="5244" class="Symbol">=</a> <a id="5246" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="5252" class="Symbol">(</a><a id="5253" href="Chapter.Fun.RedBlackTree.html#3128" class="InductiveConstructor">node</a> <a id="5258" href="Chapter.Fun.RedBlackTree.html#5230" class="Bound">z</a> <a id="5260" href="Chapter.Fun.RedBlackTree.html#5232" class="Bound">a</a> <a id="5262" href="Chapter.Fun.RedBlackTree.html#5241" class="Bound">b</a><a id="5263" class="Symbol">)</a>
<a id="5265" href="Chapter.Fun.RedBlackTree.html#5138" class="Function">balance-r</a> <a id="5275" href="Chapter.Fun.RedBlackTree.html#5275" class="Bound">z</a> <a id="5277" href="Chapter.Fun.RedBlackTree.html#5277" class="Bound">a</a> <a id="5279" class="Symbol">(</a><a id="5280" href="Chapter.Fun.RedBlackTree.html#4070" class="InductiveConstructor">red-l</a> <a id="5286" href="Chapter.Fun.RedBlackTree.html#5286" class="Bound">y</a> <a id="5288" class="Symbol">(</a><a id="5289" href="Chapter.Fun.RedBlackTree.html#2741" class="InductiveConstructor">node</a> <a id="5294" href="Chapter.Fun.RedBlackTree.html#5294" class="Bound">x</a> <a id="5296" href="Chapter.Fun.RedBlackTree.html#5296" class="Bound">b</a> <a id="5298" href="Chapter.Fun.RedBlackTree.html#5298" class="Bound">c</a><a id="5299" class="Symbol">)</a> <a id="5301" href="Chapter.Fun.RedBlackTree.html#5301" class="Bound">d</a><a id="5302" class="Symbol">)</a> <a id="5304" class="Symbol">=</a>
  <a id="5308" href="Chapter.Fun.RedBlackTree.html#3359" class="InductiveConstructor">red</a> <a id="5312" class="Symbol">(</a><a id="5313" href="Chapter.Fun.RedBlackTree.html#2741" class="InductiveConstructor">node</a> <a id="5318" href="Chapter.Fun.RedBlackTree.html#5294" class="Bound">x</a> <a id="5320" class="Symbol">(</a><a id="5321" href="Chapter.Fun.RedBlackTree.html#3128" class="InductiveConstructor">node</a> <a id="5326" href="Chapter.Fun.RedBlackTree.html#5275" class="Bound">z</a> <a id="5328" href="Chapter.Fun.RedBlackTree.html#5277" class="Bound">a</a> <a id="5330" class="Symbol">(</a><a id="5331" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="5337" href="Chapter.Fun.RedBlackTree.html#5296" class="Bound">b</a><a id="5338" class="Symbol">))</a> <a id="5341" class="Symbol">(</a><a id="5342" href="Chapter.Fun.RedBlackTree.html#3128" class="InductiveConstructor">node</a> <a id="5347" href="Chapter.Fun.RedBlackTree.html#5286" class="Bound">y</a> <a id="5349" class="Symbol">(</a><a id="5350" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="5356" href="Chapter.Fun.RedBlackTree.html#5298" class="Bound">c</a><a id="5357" class="Symbol">)</a> <a id="5359" class="Symbol">(</a><a id="5360" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="5366" href="Chapter.Fun.RedBlackTree.html#5301" class="Bound">d</a><a id="5367" class="Symbol">)))</a>
<a id="5371" href="Chapter.Fun.RedBlackTree.html#5138" class="Function">balance-r</a> <a id="5381" href="Chapter.Fun.RedBlackTree.html#5381" class="Bound">z</a> <a id="5383" href="Chapter.Fun.RedBlackTree.html#5383" class="Bound">a</a> <a id="5385" class="Symbol">(</a><a id="5386" href="Chapter.Fun.RedBlackTree.html#4135" class="InductiveConstructor">red-r</a> <a id="5392" href="Chapter.Fun.RedBlackTree.html#5392" class="Bound">y</a> <a id="5394" href="Chapter.Fun.RedBlackTree.html#5394" class="Bound">b</a> <a id="5396" class="Symbol">(</a><a id="5397" href="Chapter.Fun.RedBlackTree.html#2741" class="InductiveConstructor">node</a> <a id="5402" href="Chapter.Fun.RedBlackTree.html#5402" class="Bound">x</a> <a id="5404" href="Chapter.Fun.RedBlackTree.html#5404" class="Bound">c</a> <a id="5406" href="Chapter.Fun.RedBlackTree.html#5406" class="Bound">d</a><a id="5407" class="Symbol">))</a> <a id="5410" class="Symbol">=</a>
  <a id="5414" href="Chapter.Fun.RedBlackTree.html#3359" class="InductiveConstructor">red</a> <a id="5418" class="Symbol">(</a><a id="5419" href="Chapter.Fun.RedBlackTree.html#2741" class="InductiveConstructor">node</a> <a id="5424" href="Chapter.Fun.RedBlackTree.html#5392" class="Bound">y</a> <a id="5426" class="Symbol">(</a><a id="5427" href="Chapter.Fun.RedBlackTree.html#3128" class="InductiveConstructor">node</a> <a id="5432" href="Chapter.Fun.RedBlackTree.html#5381" class="Bound">z</a> <a id="5434" href="Chapter.Fun.RedBlackTree.html#5383" class="Bound">a</a> <a id="5436" class="Symbol">(</a><a id="5437" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="5443" href="Chapter.Fun.RedBlackTree.html#5394" class="Bound">b</a><a id="5444" class="Symbol">))</a> <a id="5447" class="Symbol">(</a><a id="5448" href="Chapter.Fun.RedBlackTree.html#3128" class="InductiveConstructor">node</a> <a id="5453" href="Chapter.Fun.RedBlackTree.html#5402" class="Bound">x</a> <a id="5455" class="Symbol">(</a><a id="5456" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="5462" href="Chapter.Fun.RedBlackTree.html#5404" class="Bound">c</a><a id="5463" class="Symbol">)</a> <a id="5465" class="Symbol">(</a><a id="5466" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="5472" href="Chapter.Fun.RedBlackTree.html#5406" class="Bound">d</a><a id="5473" class="Symbol">)))</a>
</pre>
<pre class="Agda"><a id="insertR"></a><a id="5490" href="Chapter.Fun.RedBlackTree.html#5490" class="Function">insertR</a> <a id="5498" class="Symbol">:</a> <a id="5500" class="Symbol">{</a><a id="5501" href="Chapter.Fun.RedBlackTree.html#5501" class="Bound">n</a> <a id="5503" class="Symbol">:</a> <a id="5505" href="Library.Nat.html#32" class="Datatype">ℕ</a><a id="5506" class="Symbol">}</a> <a id="5508" class="Symbol">-&gt;</a> <a id="5511" href="Chapter.Fun.RedBlackTree.html#564" class="Bound">A</a> <a id="5513" class="Symbol">-&gt;</a> <a id="5516" href="Chapter.Fun.RedBlackTree.html#2139" class="Datatype">RedTree</a> <a id="5524" href="Chapter.Fun.RedBlackTree.html#5501" class="Bound">n</a> <a id="5526" class="Symbol">-&gt;</a> <a id="5529" href="Chapter.Fun.RedBlackTree.html#3992" class="Datatype">SomeTree</a> <a id="5538" href="Chapter.Fun.RedBlackTree.html#5501" class="Bound">n</a>
<a id="insertB"></a><a id="5540" href="Chapter.Fun.RedBlackTree.html#5540" class="Function">insertB</a> <a id="5548" class="Symbol">:</a> <a id="5550" class="Symbol">{</a><a id="5551" href="Chapter.Fun.RedBlackTree.html#5551" class="Bound">n</a> <a id="5553" class="Symbol">:</a> <a id="5555" href="Library.Nat.html#32" class="Datatype">ℕ</a><a id="5556" class="Symbol">}</a> <a id="5558" class="Symbol">-&gt;</a> <a id="5561" href="Chapter.Fun.RedBlackTree.html#564" class="Bound">A</a> <a id="5563" class="Symbol">-&gt;</a> <a id="5566" href="Chapter.Fun.RedBlackTree.html#2163" class="Datatype">BlackTree</a> <a id="5576" href="Chapter.Fun.RedBlackTree.html#5551" class="Bound">n</a> <a id="5578" class="Symbol">-&gt;</a> <a id="5581" href="Chapter.Fun.RedBlackTree.html#2189" class="Datatype">RedBlackTree</a> <a id="5594" href="Chapter.Fun.RedBlackTree.html#5551" class="Bound">n</a>
<a id="insert*"></a><a id="5596" href="Chapter.Fun.RedBlackTree.html#5596" class="Function">insert*</a> <a id="5604" class="Symbol">:</a> <a id="5606" class="Symbol">{</a><a id="5607" href="Chapter.Fun.RedBlackTree.html#5607" class="Bound">n</a> <a id="5609" class="Symbol">:</a> <a id="5611" href="Library.Nat.html#32" class="Datatype">ℕ</a><a id="5612" class="Symbol">}</a> <a id="5614" class="Symbol">-&gt;</a> <a id="5617" href="Chapter.Fun.RedBlackTree.html#564" class="Bound">A</a> <a id="5619" class="Symbol">-&gt;</a> <a id="5622" href="Chapter.Fun.RedBlackTree.html#2189" class="Datatype">RedBlackTree</a> <a id="5635" href="Chapter.Fun.RedBlackTree.html#5607" class="Bound">n</a> <a id="5637" class="Symbol">-&gt;</a> <a id="5640" href="Chapter.Fun.RedBlackTree.html#3992" class="Datatype">SomeTree</a> <a id="5649" href="Chapter.Fun.RedBlackTree.html#5607" class="Bound">n</a>
</pre>
<pre class="Agda"><a id="5664" href="Chapter.Fun.RedBlackTree.html#5490" class="Function">insertR</a> <a id="5672" href="Chapter.Fun.RedBlackTree.html#5672" class="Bound">x</a> <a id="5674" class="Symbol">(</a><a id="5675" href="Chapter.Fun.RedBlackTree.html#2741" class="InductiveConstructor">node</a> <a id="5680" href="Chapter.Fun.RedBlackTree.html#5680" class="Bound">y</a> <a id="5682" href="Chapter.Fun.RedBlackTree.html#5682" class="Bound">l</a> <a id="5684" href="Chapter.Fun.RedBlackTree.html#5684" class="Bound">r</a><a id="5685" class="Symbol">)</a> <a id="5687" class="Keyword">with</a> <a id="5692" href="Chapter.Fun.RedBlackTree.html#838" class="Postulate">compare</a> <a id="5700" href="Chapter.Fun.RedBlackTree.html#5672" class="Bound">x</a> <a id="5702" href="Chapter.Fun.RedBlackTree.html#5680" class="Bound">y</a>
<a id="5704" href="Chapter.Fun.RedBlackTree.html#5490" class="Function">insertR</a> <a id="5712" href="Chapter.Fun.RedBlackTree.html#5712" class="Bound">x</a> <a id="5714" class="Symbol">(</a><a id="5715" class="InductiveConstructor">node</a> <a id="5720" href="Chapter.Fun.RedBlackTree.html#5720" class="Bound">y</a> <a id="5722" href="Chapter.Fun.RedBlackTree.html#5722" class="Bound">l</a> <a id="5724" href="Chapter.Fun.RedBlackTree.html#5724" class="Bound">r</a><a id="5725" class="Symbol">)</a> <a id="5727" class="Symbol">|</a> <a id="5729" href="Chapter.Fun.RedBlackTree.html#813" class="InductiveConstructor">EQ</a> <a id="5732" class="Symbol">=</a> <a id="5734" href="Chapter.Fun.RedBlackTree.html#4020" class="InductiveConstructor">plain</a> <a id="5740" class="Symbol">(</a><a id="5741" href="Chapter.Fun.RedBlackTree.html#3359" class="InductiveConstructor">red</a> <a id="5745" class="Symbol">(</a><a id="5746" href="Chapter.Fun.RedBlackTree.html#2741" class="InductiveConstructor">node</a> <a id="5751" href="Chapter.Fun.RedBlackTree.html#5720" class="Bound">y</a> <a id="5753" href="Chapter.Fun.RedBlackTree.html#5722" class="Bound">l</a> <a id="5755" href="Chapter.Fun.RedBlackTree.html#5724" class="Bound">r</a><a id="5756" class="Symbol">))</a>
<a id="5759" href="Chapter.Fun.RedBlackTree.html#5490" class="Function">insertR</a> <a id="5767" href="Chapter.Fun.RedBlackTree.html#5767" class="Bound">x</a> <a id="5769" class="Symbol">(</a><a id="5770" class="InductiveConstructor">node</a> <a id="5775" href="Chapter.Fun.RedBlackTree.html#5775" class="Bound">y</a> <a id="5777" href="Chapter.Fun.RedBlackTree.html#5777" class="Bound">l</a> <a id="5779" href="Chapter.Fun.RedBlackTree.html#5779" class="Bound">r</a><a id="5780" class="Symbol">)</a> <a id="5782" class="Symbol">|</a> <a id="5784" href="Chapter.Fun.RedBlackTree.html#810" class="InductiveConstructor">LT</a> <a id="5787" class="Keyword">with</a> <a id="5792" href="Chapter.Fun.RedBlackTree.html#5540" class="Function">insertB</a> <a id="5800" href="Chapter.Fun.RedBlackTree.html#5767" class="Bound">x</a> <a id="5802" href="Chapter.Fun.RedBlackTree.html#5777" class="Bound">l</a>
<a id="5804" class="Symbol">...</a> <a id="5808" class="Symbol">|</a> <a id="5810" href="Chapter.Fun.RedBlackTree.html#3359" class="InductiveConstructor">red</a> <a id="5814" href="Chapter.Fun.RedBlackTree.html#5814" class="Bound">t</a> <a id="5816" class="Symbol">=</a> <a id="5818" href="Chapter.Fun.RedBlackTree.html#4070" class="InductiveConstructor">red-l</a> <a id="5824" class="Bound">y</a> <a id="5826" href="Chapter.Fun.RedBlackTree.html#5814" class="Bound">t</a> <a id="5828" class="Bound">r</a>
<a id="5830" class="Symbol">...</a> <a id="5834" class="Symbol">|</a> <a id="5836" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="5842" href="Chapter.Fun.RedBlackTree.html#5842" class="Bound">t</a> <a id="5844" class="Symbol">=</a> <a id="5846" href="Chapter.Fun.RedBlackTree.html#4020" class="InductiveConstructor">plain</a> <a id="5852" class="Symbol">(</a><a id="5853" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="5859" href="Chapter.Fun.RedBlackTree.html#5842" class="Bound">t</a><a id="5860" class="Symbol">)</a>
<a id="5862" href="Chapter.Fun.RedBlackTree.html#5490" class="Function">insertR</a> <a id="5870" href="Chapter.Fun.RedBlackTree.html#5870" class="Bound">x</a> <a id="5872" class="Symbol">(</a><a id="5873" class="InductiveConstructor">node</a> <a id="5878" href="Chapter.Fun.RedBlackTree.html#5878" class="Bound">y</a> <a id="5880" href="Chapter.Fun.RedBlackTree.html#5880" class="Bound">l</a> <a id="5882" href="Chapter.Fun.RedBlackTree.html#5882" class="Bound">r</a><a id="5883" class="Symbol">)</a> <a id="5885" class="Symbol">|</a> <a id="5887" href="Chapter.Fun.RedBlackTree.html#816" class="InductiveConstructor">GT</a> <a id="5890" class="Keyword">with</a> <a id="5895" href="Chapter.Fun.RedBlackTree.html#5540" class="Function">insertB</a> <a id="5903" href="Chapter.Fun.RedBlackTree.html#5870" class="Bound">x</a> <a id="5905" href="Chapter.Fun.RedBlackTree.html#5882" class="Bound">r</a>
<a id="5907" class="Symbol">...</a> <a id="5911" class="Symbol">|</a> <a id="5913" href="Chapter.Fun.RedBlackTree.html#3359" class="InductiveConstructor">red</a> <a id="5917" href="Chapter.Fun.RedBlackTree.html#5917" class="Bound">t</a> <a id="5919" class="Symbol">=</a> <a id="5921" href="Chapter.Fun.RedBlackTree.html#4135" class="InductiveConstructor">red-r</a> <a id="5927" class="Bound">y</a> <a id="5929" class="Bound">l</a> <a id="5931" href="Chapter.Fun.RedBlackTree.html#5917" class="Bound">t</a>
<a id="5933" class="Symbol">...</a> <a id="5937" class="Symbol">|</a> <a id="5939" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="5945" href="Chapter.Fun.RedBlackTree.html#5945" class="Bound">t</a> <a id="5947" class="Symbol">=</a> <a id="5949" href="Chapter.Fun.RedBlackTree.html#4020" class="InductiveConstructor">plain</a> <a id="5955" class="Symbol">(</a><a id="5956" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="5962" href="Chapter.Fun.RedBlackTree.html#5945" class="Bound">t</a><a id="5963" class="Symbol">)</a>

<a id="5966" href="Chapter.Fun.RedBlackTree.html#5540" class="Function">insertB</a> <a id="5974" href="Chapter.Fun.RedBlackTree.html#5974" class="Bound">x</a> <a id="5976" href="Chapter.Fun.RedBlackTree.html#3107" class="InductiveConstructor">leaf</a> <a id="5981" class="Symbol">=</a> <a id="5983" href="Chapter.Fun.RedBlackTree.html#3359" class="InductiveConstructor">red</a> <a id="5987" class="Symbol">(</a><a id="5988" href="Chapter.Fun.RedBlackTree.html#2741" class="InductiveConstructor">node</a> <a id="5993" href="Chapter.Fun.RedBlackTree.html#5974" class="Bound">x</a> <a id="5995" href="Chapter.Fun.RedBlackTree.html#3107" class="InductiveConstructor">leaf</a> <a id="6000" href="Chapter.Fun.RedBlackTree.html#3107" class="InductiveConstructor">leaf</a><a id="6004" class="Symbol">)</a>
<a id="6006" href="Chapter.Fun.RedBlackTree.html#5540" class="Function">insertB</a> <a id="6014" href="Chapter.Fun.RedBlackTree.html#6014" class="Bound">x</a> <a id="6016" class="Symbol">(</a><a id="6017" href="Chapter.Fun.RedBlackTree.html#3128" class="InductiveConstructor">node</a> <a id="6022" href="Chapter.Fun.RedBlackTree.html#6022" class="Bound">y</a> <a id="6024" href="Chapter.Fun.RedBlackTree.html#6024" class="Bound">l</a> <a id="6026" href="Chapter.Fun.RedBlackTree.html#6026" class="Bound">r</a><a id="6027" class="Symbol">)</a> <a id="6029" class="Keyword">with</a> <a id="6034" href="Chapter.Fun.RedBlackTree.html#838" class="Postulate">compare</a> <a id="6042" href="Chapter.Fun.RedBlackTree.html#6014" class="Bound">x</a> <a id="6044" href="Chapter.Fun.RedBlackTree.html#6022" class="Bound">y</a>
<a id="6046" class="Symbol">...</a> <a id="6050" class="Symbol">|</a> <a id="6052" href="Chapter.Fun.RedBlackTree.html#810" class="InductiveConstructor">LT</a> <a id="6055" class="Symbol">=</a> <a id="6057" href="Chapter.Fun.RedBlackTree.html#4798" class="Function">balance-l</a> <a id="6067" class="Bound">y</a> <a id="6069" class="Symbol">(</a><a id="6070" href="Chapter.Fun.RedBlackTree.html#5596" class="Function">insert*</a> <a id="6078" class="Bound">x</a> <a id="6080" class="Bound">l</a><a id="6081" class="Symbol">)</a> <a id="6083" class="Bound">r</a>
<a id="6085" class="Symbol">...</a> <a id="6089" class="Symbol">|</a> <a id="6091" href="Chapter.Fun.RedBlackTree.html#813" class="InductiveConstructor">EQ</a> <a id="6094" class="Symbol">=</a> <a id="6096" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="6102" class="Symbol">(</a><a id="6103" href="Chapter.Fun.RedBlackTree.html#3128" class="InductiveConstructor">node</a> <a id="6108" class="Bound">y</a> <a id="6110" class="Bound">l</a> <a id="6112" class="Bound">r</a><a id="6113" class="Symbol">)</a>
<a id="6115" class="Symbol">...</a> <a id="6119" class="Symbol">|</a> <a id="6121" href="Chapter.Fun.RedBlackTree.html#816" class="InductiveConstructor">GT</a> <a id="6124" class="Symbol">=</a> <a id="6126" href="Chapter.Fun.RedBlackTree.html#5138" class="Function">balance-r</a> <a id="6136" class="Bound">y</a> <a id="6138" class="Bound">l</a> <a id="6140" class="Symbol">(</a><a id="6141" href="Chapter.Fun.RedBlackTree.html#5596" class="Function">insert*</a> <a id="6149" class="Bound">x</a> <a id="6151" class="Bound">r</a><a id="6152" class="Symbol">)</a>

<a id="6155" href="Chapter.Fun.RedBlackTree.html#5596" class="Function">insert*</a> <a id="6163" href="Chapter.Fun.RedBlackTree.html#6163" class="Bound">x</a> <a id="6165" class="Symbol">(</a><a id="6166" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="6172" href="Chapter.Fun.RedBlackTree.html#6172" class="Bound">t</a><a id="6173" class="Symbol">)</a> <a id="6175" class="Symbol">=</a> <a id="6177" href="Chapter.Fun.RedBlackTree.html#4020" class="InductiveConstructor">plain</a> <a id="6183" class="Symbol">(</a><a id="6184" href="Chapter.Fun.RedBlackTree.html#5540" class="Function">insertB</a> <a id="6192" href="Chapter.Fun.RedBlackTree.html#6163" class="Bound">x</a> <a id="6194" href="Chapter.Fun.RedBlackTree.html#6172" class="Bound">t</a><a id="6195" class="Symbol">)</a>
<a id="6197" href="Chapter.Fun.RedBlackTree.html#5596" class="Function">insert*</a> <a id="6205" href="Chapter.Fun.RedBlackTree.html#6205" class="Bound">x</a> <a id="6207" class="Symbol">(</a><a id="6208" href="Chapter.Fun.RedBlackTree.html#3359" class="InductiveConstructor">red</a> <a id="6212" href="Chapter.Fun.RedBlackTree.html#6212" class="Bound">t</a><a id="6213" class="Symbol">)</a> <a id="6215" class="Symbol">=</a> <a id="6217" href="Chapter.Fun.RedBlackTree.html#5490" class="Function">insertR</a> <a id="6225" href="Chapter.Fun.RedBlackTree.html#6205" class="Bound">x</a> <a id="6227" href="Chapter.Fun.RedBlackTree.html#6212" class="Bound">t</a>

<a id="blacken"></a><a id="6230" href="Chapter.Fun.RedBlackTree.html#6230" class="Function">blacken</a> <a id="6238" class="Symbol">:</a> <a id="6240" class="Symbol">{</a><a id="6241" href="Chapter.Fun.RedBlackTree.html#6241" class="Bound">n</a> <a id="6243" class="Symbol">:</a> <a id="6245" href="Library.Nat.html#32" class="Datatype">ℕ</a><a id="6246" class="Symbol">}</a> <a id="6248" class="Symbol">-&gt;</a> <a id="6251" href="Chapter.Fun.RedBlackTree.html#3992" class="Datatype">SomeTree</a> <a id="6260" href="Chapter.Fun.RedBlackTree.html#6241" class="Bound">n</a> <a id="6262" class="Symbol">-&gt;</a> <a id="6265" href="Library.Logic.html#632" class="Function">∃[</a> <a id="6268" href="Chapter.Fun.RedBlackTree.html#6268" class="Bound">m</a> <a id="6270" href="Library.Logic.html#632" class="Function">]</a> <a id="6272" href="Chapter.Fun.RedBlackTree.html#2189" class="Datatype">RedBlackTree</a> <a id="6285" href="Chapter.Fun.RedBlackTree.html#6268" class="Bound">m</a>
<a id="6287" href="Chapter.Fun.RedBlackTree.html#6230" class="Function">blacken</a> <a id="6295" class="Symbol">(</a><a id="6296" href="Chapter.Fun.RedBlackTree.html#4020" class="InductiveConstructor">plain</a> <a id="6302" class="Symbol">(</a><a id="6303" href="Chapter.Fun.RedBlackTree.html#3359" class="InductiveConstructor">red</a> <a id="6307" class="Symbol">(</a><a id="6308" href="Chapter.Fun.RedBlackTree.html#2741" class="InductiveConstructor">node</a> <a id="6313" href="Chapter.Fun.RedBlackTree.html#6313" class="Bound">x</a> <a id="6315" href="Chapter.Fun.RedBlackTree.html#6315" class="Bound">l</a> <a id="6317" href="Chapter.Fun.RedBlackTree.html#6317" class="Bound">r</a><a id="6318" class="Symbol">)))</a> <a id="6322" class="Symbol">=</a> <a id="6324" class="Symbol">_</a> <a id="6326" href="Library.Logic.html#271" class="InductiveConstructor Operator">,</a> <a id="6328" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="6334" class="Symbol">(</a><a id="6335" href="Chapter.Fun.RedBlackTree.html#3128" class="InductiveConstructor">node</a> <a id="6340" href="Chapter.Fun.RedBlackTree.html#6313" class="Bound">x</a> <a id="6342" class="Symbol">(</a><a id="6343" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="6349" href="Chapter.Fun.RedBlackTree.html#6315" class="Bound">l</a><a id="6350" class="Symbol">)</a> <a id="6352" class="Symbol">(</a><a id="6353" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="6359" href="Chapter.Fun.RedBlackTree.html#6317" class="Bound">r</a><a id="6360" class="Symbol">))</a>
<a id="6363" href="Chapter.Fun.RedBlackTree.html#6230" class="Function">blacken</a> <a id="6371" class="Symbol">(</a><a id="6372" href="Chapter.Fun.RedBlackTree.html#4020" class="InductiveConstructor">plain</a> <a id="6378" class="Symbol">(</a><a id="6379" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="6385" href="Chapter.Fun.RedBlackTree.html#6385" class="Bound">t</a><a id="6386" class="Symbol">))</a>          <a id="6398" class="Symbol">=</a> <a id="6400" class="Symbol">_</a> <a id="6402" href="Library.Logic.html#271" class="InductiveConstructor Operator">,</a> <a id="6404" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="6410" href="Chapter.Fun.RedBlackTree.html#6385" class="Bound">t</a>
<a id="6412" href="Chapter.Fun.RedBlackTree.html#6230" class="Function">blacken</a> <a id="6420" class="Symbol">(</a><a id="6421" href="Chapter.Fun.RedBlackTree.html#4070" class="InductiveConstructor">red-l</a> <a id="6427" href="Chapter.Fun.RedBlackTree.html#6427" class="Bound">x</a> <a id="6429" href="Chapter.Fun.RedBlackTree.html#6429" class="Bound">l</a> <a id="6431" href="Chapter.Fun.RedBlackTree.html#6431" class="Bound">r</a><a id="6432" class="Symbol">)</a>              <a id="6447" class="Symbol">=</a> <a id="6449" class="Symbol">_</a> <a id="6451" href="Library.Logic.html#271" class="InductiveConstructor Operator">,</a> <a id="6453" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="6459" class="Symbol">(</a><a id="6460" href="Chapter.Fun.RedBlackTree.html#3128" class="InductiveConstructor">node</a> <a id="6465" href="Chapter.Fun.RedBlackTree.html#6427" class="Bound">x</a> <a id="6467" class="Symbol">(</a><a id="6468" href="Chapter.Fun.RedBlackTree.html#3359" class="InductiveConstructor">red</a> <a id="6472" href="Chapter.Fun.RedBlackTree.html#6429" class="Bound">l</a><a id="6473" class="Symbol">)</a> <a id="6475" class="Symbol">(</a><a id="6476" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="6482" href="Chapter.Fun.RedBlackTree.html#6431" class="Bound">r</a><a id="6483" class="Symbol">))</a>
<a id="6486" href="Chapter.Fun.RedBlackTree.html#6230" class="Function">blacken</a> <a id="6494" class="Symbol">(</a><a id="6495" href="Chapter.Fun.RedBlackTree.html#4135" class="InductiveConstructor">red-r</a> <a id="6501" href="Chapter.Fun.RedBlackTree.html#6501" class="Bound">x</a> <a id="6503" href="Chapter.Fun.RedBlackTree.html#6503" class="Bound">l</a> <a id="6505" href="Chapter.Fun.RedBlackTree.html#6505" class="Bound">r</a><a id="6506" class="Symbol">)</a>              <a id="6521" class="Symbol">=</a> <a id="6523" class="Symbol">_</a> <a id="6525" href="Library.Logic.html#271" class="InductiveConstructor Operator">,</a> <a id="6527" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="6533" class="Symbol">(</a><a id="6534" href="Chapter.Fun.RedBlackTree.html#3128" class="InductiveConstructor">node</a> <a id="6539" href="Chapter.Fun.RedBlackTree.html#6501" class="Bound">x</a> <a id="6541" class="Symbol">(</a><a id="6542" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="6548" href="Chapter.Fun.RedBlackTree.html#6503" class="Bound">l</a><a id="6549" class="Symbol">)</a> <a id="6551" class="Symbol">(</a><a id="6552" href="Chapter.Fun.RedBlackTree.html#3359" class="InductiveConstructor">red</a> <a id="6556" href="Chapter.Fun.RedBlackTree.html#6505" class="Bound">r</a><a id="6557" class="Symbol">))</a>

<a id="insert"></a><a id="6561" href="Chapter.Fun.RedBlackTree.html#6561" class="Function">insert</a> <a id="6568" class="Symbol">:</a> <a id="6570" class="Symbol">{</a><a id="6571" href="Chapter.Fun.RedBlackTree.html#6571" class="Bound">n</a> <a id="6573" class="Symbol">:</a> <a id="6575" href="Library.Nat.html#32" class="Datatype">ℕ</a><a id="6576" class="Symbol">}</a> <a id="6578" class="Symbol">-&gt;</a> <a id="6581" href="Chapter.Fun.RedBlackTree.html#564" class="Bound">A</a> <a id="6583" class="Symbol">-&gt;</a> <a id="6586" href="Chapter.Fun.RedBlackTree.html#2189" class="Datatype">RedBlackTree</a> <a id="6599" href="Chapter.Fun.RedBlackTree.html#6571" class="Bound">n</a> <a id="6601" class="Symbol">-&gt;</a> <a id="6604" href="Library.Logic.html#632" class="Function">∃[</a> <a id="6607" href="Chapter.Fun.RedBlackTree.html#6607" class="Bound">m</a> <a id="6609" href="Library.Logic.html#632" class="Function">]</a> <a id="6611" href="Chapter.Fun.RedBlackTree.html#2189" class="Datatype">RedBlackTree</a> <a id="6624" href="Chapter.Fun.RedBlackTree.html#6607" class="Bound">m</a>
<a id="6626" href="Chapter.Fun.RedBlackTree.html#6561" class="Function">insert</a> <a id="6633" href="Chapter.Fun.RedBlackTree.html#6633" class="Bound">x</a> <a id="6635" href="Chapter.Fun.RedBlackTree.html#6635" class="Bound">t</a> <a id="6637" class="Symbol">=</a> <a id="6639" href="Chapter.Fun.RedBlackTree.html#6230" class="Function">blacken</a> <a id="6647" class="Symbol">(</a><a id="6648" href="Chapter.Fun.RedBlackTree.html#5596" class="Function">insert*</a> <a id="6656" href="Chapter.Fun.RedBlackTree.html#6633" class="Bound">x</a> <a id="6658" href="Chapter.Fun.RedBlackTree.html#6635" class="Bound">t</a><a id="6659" class="Symbol">)</a>
</pre>
<pre class="Agda"><a id="size*"></a><a id="6674" href="Chapter.Fun.RedBlackTree.html#6674" class="Function">size*</a> <a id="6680" class="Symbol">:</a> <a id="6682" class="Symbol">{</a><a id="6683" href="Chapter.Fun.RedBlackTree.html#6683" class="Bound">n</a> <a id="6685" class="Symbol">:</a> <a id="6687" href="Library.Nat.html#32" class="Datatype">ℕ</a><a id="6688" class="Symbol">}</a> <a id="6690" class="Symbol">-&gt;</a> <a id="6693" href="Chapter.Fun.RedBlackTree.html#2189" class="Datatype">RedBlackTree</a> <a id="6706" href="Chapter.Fun.RedBlackTree.html#6683" class="Bound">n</a> <a id="6708" class="Symbol">-&gt;</a> <a id="6711" href="Library.Nat.html#32" class="Datatype">ℕ</a>
<a id="sizeR"></a><a id="6713" href="Chapter.Fun.RedBlackTree.html#6713" class="Function">sizeR</a> <a id="6719" class="Symbol">:</a> <a id="6721" class="Symbol">{</a><a id="6722" href="Chapter.Fun.RedBlackTree.html#6722" class="Bound">n</a> <a id="6724" class="Symbol">:</a> <a id="6726" href="Library.Nat.html#32" class="Datatype">ℕ</a><a id="6727" class="Symbol">}</a> <a id="6729" class="Symbol">-&gt;</a> <a id="6732" href="Chapter.Fun.RedBlackTree.html#2139" class="Datatype">RedTree</a> <a id="6740" href="Chapter.Fun.RedBlackTree.html#6722" class="Bound">n</a> <a id="6742" class="Symbol">-&gt;</a> <a id="6745" href="Library.Nat.html#32" class="Datatype">ℕ</a>
<a id="sizeB"></a><a id="6747" href="Chapter.Fun.RedBlackTree.html#6747" class="Function">sizeB</a> <a id="6753" class="Symbol">:</a> <a id="6755" class="Symbol">{</a><a id="6756" href="Chapter.Fun.RedBlackTree.html#6756" class="Bound">n</a> <a id="6758" class="Symbol">:</a> <a id="6760" href="Library.Nat.html#32" class="Datatype">ℕ</a><a id="6761" class="Symbol">}</a> <a id="6763" class="Symbol">-&gt;</a> <a id="6766" href="Chapter.Fun.RedBlackTree.html#2163" class="Datatype">BlackTree</a> <a id="6776" href="Chapter.Fun.RedBlackTree.html#6756" class="Bound">n</a> <a id="6778" class="Symbol">-&gt;</a> <a id="6781" href="Library.Nat.html#32" class="Datatype">ℕ</a>

<a id="6784" href="Chapter.Fun.RedBlackTree.html#6674" class="Function">size*</a> <a id="6790" class="Symbol">(</a><a id="6791" href="Chapter.Fun.RedBlackTree.html#3359" class="InductiveConstructor">red</a>   <a id="6797" href="Chapter.Fun.RedBlackTree.html#6797" class="Bound">t</a><a id="6798" class="Symbol">)</a> <a id="6800" class="Symbol">=</a> <a id="6802" href="Chapter.Fun.RedBlackTree.html#6713" class="Function">sizeR</a> <a id="6808" href="Chapter.Fun.RedBlackTree.html#6797" class="Bound">t</a>
<a id="6810" href="Chapter.Fun.RedBlackTree.html#6674" class="Function">size*</a> <a id="6816" class="Symbol">(</a><a id="6817" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="6823" href="Chapter.Fun.RedBlackTree.html#6823" class="Bound">t</a><a id="6824" class="Symbol">)</a> <a id="6826" class="Symbol">=</a> <a id="6828" href="Chapter.Fun.RedBlackTree.html#6747" class="Function">sizeB</a> <a id="6834" href="Chapter.Fun.RedBlackTree.html#6823" class="Bound">t</a>

<a id="6837" href="Chapter.Fun.RedBlackTree.html#6713" class="Function">sizeR</a> <a id="6843" class="Symbol">(</a><a id="6844" href="Chapter.Fun.RedBlackTree.html#2741" class="InductiveConstructor">node</a> <a id="6849" class="Symbol">_</a> <a id="6851" href="Chapter.Fun.RedBlackTree.html#6851" class="Bound">l</a> <a id="6853" href="Chapter.Fun.RedBlackTree.html#6853" class="Bound">r</a><a id="6854" class="Symbol">)</a> <a id="6856" class="Symbol">=</a> <a id="6858" href="Library.Nat.html#59" class="InductiveConstructor">succ</a> <a id="6863" class="Symbol">(</a><a id="6864" href="Chapter.Fun.RedBlackTree.html#6747" class="Function">sizeB</a> <a id="6870" href="Chapter.Fun.RedBlackTree.html#6851" class="Bound">l</a> <a id="6872" href="Library.Nat.html#145" class="Function Operator">+</a> <a id="6874" href="Chapter.Fun.RedBlackTree.html#6747" class="Function">sizeB</a> <a id="6880" href="Chapter.Fun.RedBlackTree.html#6853" class="Bound">r</a><a id="6881" class="Symbol">)</a>

<a id="6884" href="Chapter.Fun.RedBlackTree.html#6747" class="Function">sizeB</a> <a id="6890" href="Chapter.Fun.RedBlackTree.html#3107" class="InductiveConstructor">leaf</a> <a id="6895" class="Symbol">=</a> <a id="6897" class="Number">0</a>
<a id="6899" href="Chapter.Fun.RedBlackTree.html#6747" class="Function">sizeB</a> <a id="6905" class="Symbol">(</a><a id="6906" href="Chapter.Fun.RedBlackTree.html#3128" class="InductiveConstructor">node</a> <a id="6911" class="Symbol">_</a> <a id="6913" href="Chapter.Fun.RedBlackTree.html#6913" class="Bound">l</a> <a id="6915" href="Chapter.Fun.RedBlackTree.html#6915" class="Bound">r</a><a id="6916" class="Symbol">)</a> <a id="6918" class="Symbol">=</a> <a id="6920" href="Library.Nat.html#59" class="InductiveConstructor">succ</a> <a id="6925" class="Symbol">(</a><a id="6926" href="Chapter.Fun.RedBlackTree.html#6674" class="Function">size*</a> <a id="6932" href="Chapter.Fun.RedBlackTree.html#6913" class="Bound">l</a> <a id="6934" href="Library.Nat.html#145" class="Function Operator">+</a> <a id="6936" href="Chapter.Fun.RedBlackTree.html#6674" class="Function">size*</a> <a id="6942" href="Chapter.Fun.RedBlackTree.html#6915" class="Bound">r</a><a id="6943" class="Symbol">)</a>

<a id="⌊size*⌋"></a><a id="6946" href="Chapter.Fun.RedBlackTree.html#6946" class="Function">⌊size*⌋</a> <a id="6954" class="Symbol">:</a> <a id="6956" class="Symbol">{</a><a id="6957" href="Chapter.Fun.RedBlackTree.html#6957" class="Bound">n</a> <a id="6959" class="Symbol">:</a> <a id="6961" href="Library.Nat.html#32" class="Datatype">ℕ</a><a id="6962" class="Symbol">}</a> <a id="6964" class="Symbol">(</a><a id="6965" href="Chapter.Fun.RedBlackTree.html#6965" class="Bound">t</a> <a id="6967" class="Symbol">:</a> <a id="6969" href="Chapter.Fun.RedBlackTree.html#2189" class="Datatype">RedBlackTree</a> <a id="6982" href="Chapter.Fun.RedBlackTree.html#6957" class="Bound">n</a><a id="6983" class="Symbol">)</a> <a id="6985" class="Symbol">-&gt;</a> <a id="6988" class="Number">2</a> <a id="6990" href="Library.Nat.html#352" class="Function Operator">^</a> <a id="6992" href="Chapter.Fun.RedBlackTree.html#6957" class="Bound">n</a> <a id="6994" href="Library.LessThan.html#210" class="Datatype Operator">&lt;=</a> <a id="6997" href="Library.Nat.html#59" class="InductiveConstructor">succ</a> <a id="7002" class="Symbol">(</a><a id="7003" href="Chapter.Fun.RedBlackTree.html#6674" class="Function">size*</a> <a id="7009" href="Chapter.Fun.RedBlackTree.html#6965" class="Bound">t</a><a id="7010" class="Symbol">)</a>
<a id="⌊sizeR⌋"></a><a id="7012" href="Chapter.Fun.RedBlackTree.html#7012" class="Function">⌊sizeR⌋</a> <a id="7020" class="Symbol">:</a> <a id="7022" class="Symbol">{</a><a id="7023" href="Chapter.Fun.RedBlackTree.html#7023" class="Bound">n</a> <a id="7025" class="Symbol">:</a> <a id="7027" href="Library.Nat.html#32" class="Datatype">ℕ</a><a id="7028" class="Symbol">}</a> <a id="7030" class="Symbol">(</a><a id="7031" href="Chapter.Fun.RedBlackTree.html#7031" class="Bound">t</a> <a id="7033" class="Symbol">:</a> <a id="7035" href="Chapter.Fun.RedBlackTree.html#2139" class="Datatype">RedTree</a> <a id="7043" href="Chapter.Fun.RedBlackTree.html#7023" class="Bound">n</a><a id="7044" class="Symbol">)</a>      <a id="7051" class="Symbol">-&gt;</a> <a id="7054" class="Number">2</a> <a id="7056" href="Library.Nat.html#352" class="Function Operator">^</a> <a id="7058" href="Chapter.Fun.RedBlackTree.html#7023" class="Bound">n</a> <a id="7060" href="Library.LessThan.html#210" class="Datatype Operator">&lt;=</a> <a id="7063" href="Chapter.Fun.RedBlackTree.html#6713" class="Function">sizeR</a> <a id="7069" href="Chapter.Fun.RedBlackTree.html#7031" class="Bound">t</a>
<a id="⌊sizeB⌋"></a><a id="7071" href="Chapter.Fun.RedBlackTree.html#7071" class="Function">⌊sizeB⌋</a> <a id="7079" class="Symbol">:</a> <a id="7081" class="Symbol">{</a><a id="7082" href="Chapter.Fun.RedBlackTree.html#7082" class="Bound">n</a> <a id="7084" class="Symbol">:</a> <a id="7086" href="Library.Nat.html#32" class="Datatype">ℕ</a><a id="7087" class="Symbol">}</a> <a id="7089" class="Symbol">(</a><a id="7090" href="Chapter.Fun.RedBlackTree.html#7090" class="Bound">t</a> <a id="7092" class="Symbol">:</a> <a id="7094" href="Chapter.Fun.RedBlackTree.html#2163" class="Datatype">BlackTree</a> <a id="7104" href="Chapter.Fun.RedBlackTree.html#7082" class="Bound">n</a><a id="7105" class="Symbol">)</a>    <a id="7110" class="Symbol">-&gt;</a> <a id="7113" class="Number">2</a> <a id="7115" href="Library.Nat.html#352" class="Function Operator">^</a> <a id="7117" href="Chapter.Fun.RedBlackTree.html#7082" class="Bound">n</a> <a id="7119" href="Library.LessThan.html#210" class="Datatype Operator">&lt;=</a> <a id="7122" href="Library.Nat.html#59" class="InductiveConstructor">succ</a> <a id="7127" class="Symbol">(</a><a id="7128" href="Chapter.Fun.RedBlackTree.html#6747" class="Function">sizeB</a> <a id="7134" href="Chapter.Fun.RedBlackTree.html#7090" class="Bound">t</a><a id="7135" class="Symbol">)</a>

<a id="7138" href="Chapter.Fun.RedBlackTree.html#6946" class="Function">⌊size*⌋</a> <a id="7146" class="Symbol">(</a><a id="7147" href="Chapter.Fun.RedBlackTree.html#3359" class="InductiveConstructor">red</a>   <a id="7153" href="Chapter.Fun.RedBlackTree.html#7153" class="Bound">t</a><a id="7154" class="Symbol">)</a> <a id="7156" class="Symbol">=</a> <a id="7158" href="Library.LessThan.html#987" class="Function">le-succ-r</a> <a id="7168" class="Symbol">(</a><a id="7169" href="Chapter.Fun.RedBlackTree.html#7012" class="Function">⌊sizeR⌋</a> <a id="7177" href="Chapter.Fun.RedBlackTree.html#7153" class="Bound">t</a><a id="7178" class="Symbol">)</a>
<a id="7180" href="Chapter.Fun.RedBlackTree.html#6946" class="Function">⌊size*⌋</a> <a id="7188" class="Symbol">(</a><a id="7189" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="7195" href="Chapter.Fun.RedBlackTree.html#7195" class="Bound">t</a><a id="7196" class="Symbol">)</a> <a id="7198" class="Symbol">=</a> <a id="7200" href="Chapter.Fun.RedBlackTree.html#7071" class="Function">⌊sizeB⌋</a> <a id="7208" href="Chapter.Fun.RedBlackTree.html#7195" class="Bound">t</a>

<a id="7211" href="Chapter.Fun.RedBlackTree.html#7012" class="Function">⌊sizeR⌋</a> <a id="7219" class="Symbol">{</a><a id="7220" href="Chapter.Fun.RedBlackTree.html#7220" class="Bound">n</a><a id="7221" class="Symbol">}</a> <a id="7223" class="Symbol">(</a><a id="7224" href="Chapter.Fun.RedBlackTree.html#2741" class="InductiveConstructor">node</a> <a id="7229" class="Symbol">_</a> <a id="7231" href="Chapter.Fun.RedBlackTree.html#7231" class="Bound">l</a> <a id="7233" href="Chapter.Fun.RedBlackTree.html#7233" class="Bound">r</a><a id="7234" class="Symbol">)</a> <a id="7236" class="Symbol">=</a>
  <a id="7240" href="Library.LessThan.Reasoning.html#201" class="Function Operator">begin</a>
    <a id="7250" class="Number">2</a> <a id="7252" href="Library.Nat.html#352" class="Function Operator">^</a> <a id="7254" href="Chapter.Fun.RedBlackTree.html#7220" class="Bound">n</a>                    <a id="7275" href="Library.LessThan.Reasoning.html#297" class="Function Operator">==⟨</a> <a id="7279" href="Library.Equality.html#226" class="Function">symm</a> <a id="7284" class="Symbol">(</a><a id="7285" href="Library.Nat.Properties.html#536" class="Function">+-unit-r</a> <a id="7294" class="Symbol">(</a><a id="7295" class="Number">2</a> <a id="7297" href="Library.Nat.html#352" class="Function Operator">^</a> <a id="7299" href="Chapter.Fun.RedBlackTree.html#7220" class="Bound">n</a><a id="7300" class="Symbol">))</a> <a id="7303" href="Library.LessThan.Reasoning.html#297" class="Function Operator">⟩</a>
    <a id="7309" class="Number">2</a> <a id="7311" href="Library.Nat.html#352" class="Function Operator">^</a> <a id="7313" href="Chapter.Fun.RedBlackTree.html#7220" class="Bound">n</a> <a id="7315" href="Library.Nat.html#145" class="Function Operator">+</a> <a id="7317" class="Number">0</a>                <a id="7334" href="Library.LessThan.Reasoning.html#377" class="Function Operator">&lt;=⟨</a> <a id="7338" href="Library.LessThan.html#1417" class="Function">le-cong-+</a> <a id="7348" href="Library.LessThan.html#360" class="Function">le-refl</a> <a id="7356" href="Library.LessThan.html#239" class="InductiveConstructor">le-zero</a> <a id="7364" href="Library.LessThan.Reasoning.html#377" class="Function Operator">⟩</a>
    <a id="7370" class="Number">2</a> <a id="7372" href="Library.Nat.html#352" class="Function Operator">^</a> <a id="7374" href="Chapter.Fun.RedBlackTree.html#7220" class="Bound">n</a> <a id="7376" href="Library.Nat.html#145" class="Function Operator">+</a> <a id="7378" href="Chapter.Fun.RedBlackTree.html#6747" class="Function">sizeB</a> <a id="7384" href="Chapter.Fun.RedBlackTree.html#7233" class="Bound">r</a>          <a id="7395" href="Library.LessThan.Reasoning.html#377" class="Function Operator">&lt;=⟨</a> <a id="7399" href="Library.LessThan.html#1417" class="Function">le-cong-+</a> <a id="7409" class="Symbol">(</a><a id="7410" href="Chapter.Fun.RedBlackTree.html#7071" class="Function">⌊sizeB⌋</a> <a id="7418" href="Chapter.Fun.RedBlackTree.html#7231" class="Bound">l</a><a id="7419" class="Symbol">)</a> <a id="7421" href="Library.LessThan.html#360" class="Function">le-refl</a> <a id="7429" href="Library.LessThan.Reasoning.html#377" class="Function Operator">⟩</a>
    <a id="7435" href="Library.Nat.html#59" class="InductiveConstructor">succ</a> <a id="7440" class="Symbol">(</a><a id="7441" href="Chapter.Fun.RedBlackTree.html#6747" class="Function">sizeB</a> <a id="7447" href="Chapter.Fun.RedBlackTree.html#7231" class="Bound">l</a><a id="7448" class="Symbol">)</a> <a id="7450" href="Library.Nat.html#145" class="Function Operator">+</a> <a id="7452" href="Chapter.Fun.RedBlackTree.html#6747" class="Function">sizeB</a> <a id="7458" href="Chapter.Fun.RedBlackTree.html#7233" class="Bound">r</a>
  <a id="7462" href="Library.LessThan.Reasoning.html#254" class="Function Operator">end</a>

<a id="7467" href="Chapter.Fun.RedBlackTree.html#7071" class="Function">⌊sizeB⌋</a> <a id="7475" href="Chapter.Fun.RedBlackTree.html#3107" class="InductiveConstructor">leaf</a> <a id="7480" class="Symbol">=</a> <a id="7482" href="Library.LessThan.html#271" class="InductiveConstructor">le-succ</a> <a id="7490" href="Library.LessThan.html#239" class="InductiveConstructor">le-zero</a>
<a id="7498" href="Chapter.Fun.RedBlackTree.html#7071" class="Function">⌊sizeB⌋</a> <a id="7506" class="Symbol">{</a><a id="7507" href="Library.Nat.html#59" class="InductiveConstructor">succ</a> <a id="7512" href="Chapter.Fun.RedBlackTree.html#7512" class="Bound">n</a><a id="7513" class="Symbol">}</a> <a id="7515" class="Symbol">(</a><a id="7516" href="Chapter.Fun.RedBlackTree.html#3128" class="InductiveConstructor">node</a> <a id="7521" class="Symbol">_</a> <a id="7523" href="Chapter.Fun.RedBlackTree.html#7523" class="Bound">l</a> <a id="7525" href="Chapter.Fun.RedBlackTree.html#7525" class="Bound">r</a><a id="7526" class="Symbol">)</a> <a id="7528" class="Symbol">=</a>
  <a id="7532" href="Library.LessThan.Reasoning.html#201" class="Function Operator">begin</a>
    <a id="7542" class="Number">2</a> <a id="7544" href="Library.Nat.html#352" class="Function Operator">^</a> <a id="7546" href="Chapter.Fun.RedBlackTree.html#7512" class="Bound">n</a> <a id="7548" href="Library.Nat.html#145" class="Function Operator">+</a> <a id="7550" class="Symbol">(</a><a id="7551" class="Number">2</a> <a id="7553" href="Library.Nat.html#352" class="Function Operator">^</a> <a id="7555" href="Chapter.Fun.RedBlackTree.html#7512" class="Bound">n</a> <a id="7557" href="Library.Nat.html#145" class="Function Operator">+</a> <a id="7559" class="Number">0</a><a id="7560" class="Symbol">)</a>             <a id="7574" href="Library.LessThan.Reasoning.html#297" class="Function Operator">==⟨</a> <a id="7578" href="Library.Equality.html#226" class="Function">symm</a> <a id="7583" class="Symbol">(</a><a id="7584" href="Library.Equality.html#373" class="Function">cong</a> <a id="7589" class="Symbol">(</a><a id="7590" class="Number">2</a> <a id="7592" href="Library.Nat.html#352" class="Function Operator">^</a> <a id="7594" href="Chapter.Fun.RedBlackTree.html#7512" class="Bound">n</a> <a id="7596" href="Library.Nat.html#145" class="Function Operator">+_</a><a id="7598" class="Symbol">)</a> <a id="7600" class="Symbol">(</a><a id="7601" href="Library.Equality.html#226" class="Function">symm</a> <a id="7606" class="Symbol">(</a><a id="7607" href="Library.Nat.Properties.html#536" class="Function">+-unit-r</a> <a id="7616" class="Symbol">(</a><a id="7617" class="Number">2</a> <a id="7619" href="Library.Nat.html#352" class="Function Operator">^</a> <a id="7621" href="Chapter.Fun.RedBlackTree.html#7512" class="Bound">n</a><a id="7622" class="Symbol">))))</a> <a id="7627" href="Library.LessThan.Reasoning.html#297" class="Function Operator">⟩</a>
    <a id="7633" class="Number">2</a> <a id="7635" href="Library.Nat.html#352" class="Function Operator">^</a> <a id="7637" href="Chapter.Fun.RedBlackTree.html#7512" class="Bound">n</a> <a id="7639" href="Library.Nat.html#145" class="Function Operator">+</a> <a id="7641" class="Number">2</a> <a id="7643" href="Library.Nat.html#352" class="Function Operator">^</a> <a id="7645" href="Chapter.Fun.RedBlackTree.html#7512" class="Bound">n</a>                   <a id="7665" href="Library.LessThan.Reasoning.html#377" class="Function Operator">&lt;=⟨</a> <a id="7669" href="Library.LessThan.html#1417" class="Function">le-cong-+</a> <a id="7679" class="Symbol">(</a><a id="7680" href="Chapter.Fun.RedBlackTree.html#6946" class="Function">⌊size*⌋</a> <a id="7688" href="Chapter.Fun.RedBlackTree.html#7523" class="Bound">l</a><a id="7689" class="Symbol">)</a> <a id="7691" class="Symbol">(</a><a id="7692" href="Chapter.Fun.RedBlackTree.html#6946" class="Function">⌊size*⌋</a> <a id="7700" href="Chapter.Fun.RedBlackTree.html#7525" class="Bound">r</a><a id="7701" class="Symbol">)</a> <a id="7703" href="Library.LessThan.Reasoning.html#377" class="Function Operator">⟩</a>
    <a id="7709" href="Library.Nat.html#59" class="InductiveConstructor">succ</a> <a id="7714" class="Symbol">(</a><a id="7715" href="Chapter.Fun.RedBlackTree.html#6674" class="Function">size*</a> <a id="7721" href="Chapter.Fun.RedBlackTree.html#7523" class="Bound">l</a><a id="7722" class="Symbol">)</a> <a id="7724" href="Library.Nat.html#145" class="Function Operator">+</a> <a id="7726" href="Library.Nat.html#59" class="InductiveConstructor">succ</a> <a id="7731" class="Symbol">(</a><a id="7732" href="Chapter.Fun.RedBlackTree.html#6674" class="Function">size*</a> <a id="7738" href="Chapter.Fun.RedBlackTree.html#7525" class="Bound">r</a><a id="7739" class="Symbol">)</a> <a id="7741" href="Library.LessThan.Reasoning.html#297" class="Function Operator">==⟨</a> <a id="7745" href="Library.Equality.html#226" class="Function">symm</a> <a id="7750" class="Symbol">(</a><a id="7751" href="Library.Nat.Properties.html#370" class="Function">+-succ</a> <a id="7758" class="Symbol">(</a><a id="7759" href="Library.Nat.html#59" class="InductiveConstructor">succ</a> <a id="7764" class="Symbol">(</a><a id="7765" href="Chapter.Fun.RedBlackTree.html#6674" class="Function">size*</a> <a id="7771" href="Chapter.Fun.RedBlackTree.html#7523" class="Bound">l</a><a id="7772" class="Symbol">))</a> <a id="7775" class="Symbol">(</a><a id="7776" href="Chapter.Fun.RedBlackTree.html#6674" class="Function">size*</a> <a id="7782" href="Chapter.Fun.RedBlackTree.html#7525" class="Bound">r</a><a id="7783" class="Symbol">))</a> <a id="7786" href="Library.LessThan.Reasoning.html#297" class="Function Operator">⟩</a>
    <a id="7792" href="Library.Nat.html#59" class="InductiveConstructor">succ</a> <a id="7797" class="Symbol">(</a><a id="7798" href="Library.Nat.html#59" class="InductiveConstructor">succ</a> <a id="7803" class="Symbol">(</a><a id="7804" href="Chapter.Fun.RedBlackTree.html#6674" class="Function">size*</a> <a id="7810" href="Chapter.Fun.RedBlackTree.html#7523" class="Bound">l</a> <a id="7812" href="Library.Nat.html#145" class="Function Operator">+</a> <a id="7814" href="Chapter.Fun.RedBlackTree.html#6674" class="Function">size*</a> <a id="7820" href="Chapter.Fun.RedBlackTree.html#7525" class="Bound">r</a><a id="7821" class="Symbol">))</a>
  <a id="7826" href="Library.LessThan.Reasoning.html#254" class="Function Operator">end</a>
</pre>
<pre class="Agda"><a id="depth*"></a><a id="7843" href="Chapter.Fun.RedBlackTree.html#7843" class="Function">depth*</a> <a id="7850" class="Symbol">:</a> <a id="7852" class="Symbol">{</a><a id="7853" href="Chapter.Fun.RedBlackTree.html#7853" class="Bound">n</a> <a id="7855" class="Symbol">:</a> <a id="7857" href="Library.Nat.html#32" class="Datatype">ℕ</a><a id="7858" class="Symbol">}</a> <a id="7860" class="Symbol">-&gt;</a> <a id="7863" href="Chapter.Fun.RedBlackTree.html#2189" class="Datatype">RedBlackTree</a> <a id="7876" href="Chapter.Fun.RedBlackTree.html#7853" class="Bound">n</a> <a id="7878" class="Symbol">-&gt;</a> <a id="7881" href="Library.Nat.html#32" class="Datatype">ℕ</a>
<a id="depthR"></a><a id="7883" href="Chapter.Fun.RedBlackTree.html#7883" class="Function">depthR</a> <a id="7890" class="Symbol">:</a> <a id="7892" class="Symbol">{</a><a id="7893" href="Chapter.Fun.RedBlackTree.html#7893" class="Bound">n</a> <a id="7895" class="Symbol">:</a> <a id="7897" href="Library.Nat.html#32" class="Datatype">ℕ</a><a id="7898" class="Symbol">}</a> <a id="7900" class="Symbol">-&gt;</a> <a id="7903" href="Chapter.Fun.RedBlackTree.html#2139" class="Datatype">RedTree</a> <a id="7911" href="Chapter.Fun.RedBlackTree.html#7893" class="Bound">n</a> <a id="7913" class="Symbol">-&gt;</a> <a id="7916" href="Library.Nat.html#32" class="Datatype">ℕ</a>
<a id="depthB"></a><a id="7918" href="Chapter.Fun.RedBlackTree.html#7918" class="Function">depthB</a> <a id="7925" class="Symbol">:</a> <a id="7927" class="Symbol">{</a><a id="7928" href="Chapter.Fun.RedBlackTree.html#7928" class="Bound">n</a> <a id="7930" class="Symbol">:</a> <a id="7932" href="Library.Nat.html#32" class="Datatype">ℕ</a><a id="7933" class="Symbol">}</a> <a id="7935" class="Symbol">-&gt;</a> <a id="7938" href="Chapter.Fun.RedBlackTree.html#2163" class="Datatype">BlackTree</a> <a id="7948" href="Chapter.Fun.RedBlackTree.html#7928" class="Bound">n</a> <a id="7950" class="Symbol">-&gt;</a> <a id="7953" href="Library.Nat.html#32" class="Datatype">ℕ</a>

<a id="7956" href="Chapter.Fun.RedBlackTree.html#7843" class="Function">depth*</a> <a id="7963" class="Symbol">(</a><a id="7964" href="Chapter.Fun.RedBlackTree.html#3359" class="InductiveConstructor">red</a> <a id="7968" href="Chapter.Fun.RedBlackTree.html#7968" class="Bound">t</a><a id="7969" class="Symbol">)</a> <a id="7971" class="Symbol">=</a> <a id="7973" href="Chapter.Fun.RedBlackTree.html#7883" class="Function">depthR</a> <a id="7980" href="Chapter.Fun.RedBlackTree.html#7968" class="Bound">t</a>
<a id="7982" href="Chapter.Fun.RedBlackTree.html#7843" class="Function">depth*</a> <a id="7989" class="Symbol">(</a><a id="7990" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="7996" href="Chapter.Fun.RedBlackTree.html#7996" class="Bound">t</a><a id="7997" class="Symbol">)</a> <a id="7999" class="Symbol">=</a> <a id="8001" href="Chapter.Fun.RedBlackTree.html#7918" class="Function">depthB</a> <a id="8008" href="Chapter.Fun.RedBlackTree.html#7996" class="Bound">t</a>

<a id="8011" href="Chapter.Fun.RedBlackTree.html#7883" class="Function">depthR</a> <a id="8018" class="Symbol">(</a><a id="8019" href="Chapter.Fun.RedBlackTree.html#2741" class="InductiveConstructor">node</a> <a id="8024" class="Symbol">_</a> <a id="8026" href="Chapter.Fun.RedBlackTree.html#8026" class="Bound">l</a> <a id="8028" href="Chapter.Fun.RedBlackTree.html#8028" class="Bound">r</a><a id="8029" class="Symbol">)</a> <a id="8031" class="Symbol">=</a> <a id="8033" href="Library.Nat.html#59" class="InductiveConstructor">succ</a> <a id="8038" class="Symbol">(</a><a id="8039" href="Library.Nat.html#508" class="Function">max</a> <a id="8043" class="Symbol">(</a><a id="8044" href="Chapter.Fun.RedBlackTree.html#7918" class="Function">depthB</a> <a id="8051" href="Chapter.Fun.RedBlackTree.html#8026" class="Bound">l</a><a id="8052" class="Symbol">)</a> <a id="8054" class="Symbol">(</a><a id="8055" href="Chapter.Fun.RedBlackTree.html#7918" class="Function">depthB</a> <a id="8062" href="Chapter.Fun.RedBlackTree.html#8028" class="Bound">r</a><a id="8063" class="Symbol">))</a>

<a id="8067" href="Chapter.Fun.RedBlackTree.html#7918" class="Function">depthB</a> <a id="8074" href="Chapter.Fun.RedBlackTree.html#3107" class="InductiveConstructor">leaf</a> <a id="8079" class="Symbol">=</a> <a id="8081" class="Number">0</a>
<a id="8083" href="Chapter.Fun.RedBlackTree.html#7918" class="Function">depthB</a> <a id="8090" class="Symbol">(</a><a id="8091" href="Chapter.Fun.RedBlackTree.html#3128" class="InductiveConstructor">node</a> <a id="8096" class="Symbol">_</a> <a id="8098" href="Chapter.Fun.RedBlackTree.html#8098" class="Bound">l</a> <a id="8100" href="Chapter.Fun.RedBlackTree.html#8100" class="Bound">r</a><a id="8101" class="Symbol">)</a> <a id="8103" class="Symbol">=</a> <a id="8105" href="Library.Nat.html#59" class="InductiveConstructor">succ</a> <a id="8110" class="Symbol">(</a><a id="8111" href="Library.Nat.html#508" class="Function">max</a> <a id="8115" class="Symbol">(</a><a id="8116" href="Chapter.Fun.RedBlackTree.html#7843" class="Function">depth*</a> <a id="8123" href="Chapter.Fun.RedBlackTree.html#8098" class="Bound">l</a><a id="8124" class="Symbol">)</a> <a id="8126" class="Symbol">(</a><a id="8127" href="Chapter.Fun.RedBlackTree.html#7843" class="Function">depth*</a> <a id="8134" href="Chapter.Fun.RedBlackTree.html#8100" class="Bound">r</a><a id="8135" class="Symbol">))</a>

<a id="⌈depth*⌉"></a><a id="8139" href="Chapter.Fun.RedBlackTree.html#8139" class="Function">⌈depth*⌉</a> <a id="8148" class="Symbol">:</a> <a id="8150" class="Symbol">{</a><a id="8151" href="Chapter.Fun.RedBlackTree.html#8151" class="Bound">n</a> <a id="8153" class="Symbol">:</a> <a id="8155" href="Library.Nat.html#32" class="Datatype">ℕ</a><a id="8156" class="Symbol">}</a> <a id="8158" class="Symbol">(</a><a id="8159" href="Chapter.Fun.RedBlackTree.html#8159" class="Bound">t</a> <a id="8161" class="Symbol">:</a> <a id="8163" href="Chapter.Fun.RedBlackTree.html#2189" class="Datatype">RedBlackTree</a> <a id="8176" href="Chapter.Fun.RedBlackTree.html#8151" class="Bound">n</a><a id="8177" class="Symbol">)</a> <a id="8179" class="Symbol">-&gt;</a> <a id="8182" href="Chapter.Fun.RedBlackTree.html#7843" class="Function">depth*</a> <a id="8189" href="Chapter.Fun.RedBlackTree.html#8159" class="Bound">t</a> <a id="8191" href="Library.LessThan.html#210" class="Datatype Operator">&lt;=</a> <a id="8194" href="Library.Nat.html#59" class="InductiveConstructor">succ</a> <a id="8199" class="Symbol">(</a><a id="8200" class="Number">2</a> <a id="8202" href="Library.Nat.html#293" class="Function Operator">*</a> <a id="8204" href="Chapter.Fun.RedBlackTree.html#8151" class="Bound">n</a><a id="8205" class="Symbol">)</a>
<a id="⌈depthR⌉"></a><a id="8207" href="Chapter.Fun.RedBlackTree.html#8207" class="Function">⌈depthR⌉</a> <a id="8216" class="Symbol">:</a> <a id="8218" class="Symbol">{</a><a id="8219" href="Chapter.Fun.RedBlackTree.html#8219" class="Bound">n</a> <a id="8221" class="Symbol">:</a> <a id="8223" href="Library.Nat.html#32" class="Datatype">ℕ</a><a id="8224" class="Symbol">}</a> <a id="8226" class="Symbol">(</a><a id="8227" href="Chapter.Fun.RedBlackTree.html#8227" class="Bound">t</a> <a id="8229" class="Symbol">:</a> <a id="8231" href="Chapter.Fun.RedBlackTree.html#2139" class="Datatype">RedTree</a> <a id="8239" href="Chapter.Fun.RedBlackTree.html#8219" class="Bound">n</a><a id="8240" class="Symbol">)</a> <a id="8242" class="Symbol">-&gt;</a> <a id="8245" href="Chapter.Fun.RedBlackTree.html#7883" class="Function">depthR</a> <a id="8252" href="Chapter.Fun.RedBlackTree.html#8227" class="Bound">t</a> <a id="8254" href="Library.LessThan.html#210" class="Datatype Operator">&lt;=</a> <a id="8257" href="Library.Nat.html#59" class="InductiveConstructor">succ</a> <a id="8262" class="Symbol">(</a><a id="8263" class="Number">2</a> <a id="8265" href="Library.Nat.html#293" class="Function Operator">*</a> <a id="8267" href="Chapter.Fun.RedBlackTree.html#8219" class="Bound">n</a><a id="8268" class="Symbol">)</a>
<a id="⌈depthB⌉"></a><a id="8270" href="Chapter.Fun.RedBlackTree.html#8270" class="Function">⌈depthB⌉</a> <a id="8279" class="Symbol">:</a> <a id="8281" class="Symbol">{</a><a id="8282" href="Chapter.Fun.RedBlackTree.html#8282" class="Bound">n</a> <a id="8284" class="Symbol">:</a> <a id="8286" href="Library.Nat.html#32" class="Datatype">ℕ</a><a id="8287" class="Symbol">}</a> <a id="8289" class="Symbol">(</a><a id="8290" href="Chapter.Fun.RedBlackTree.html#8290" class="Bound">t</a> <a id="8292" class="Symbol">:</a> <a id="8294" href="Chapter.Fun.RedBlackTree.html#2163" class="Datatype">BlackTree</a> <a id="8304" href="Chapter.Fun.RedBlackTree.html#8282" class="Bound">n</a><a id="8305" class="Symbol">)</a> <a id="8307" class="Symbol">-&gt;</a> <a id="8310" href="Chapter.Fun.RedBlackTree.html#7918" class="Function">depthB</a> <a id="8317" href="Chapter.Fun.RedBlackTree.html#8290" class="Bound">t</a> <a id="8319" href="Library.LessThan.html#210" class="Datatype Operator">&lt;=</a> <a id="8322" class="Number">2</a> <a id="8324" href="Library.Nat.html#293" class="Function Operator">*</a> <a id="8326" href="Chapter.Fun.RedBlackTree.html#8282" class="Bound">n</a>

<a id="8329" href="Chapter.Fun.RedBlackTree.html#8139" class="Function">⌈depth*⌉</a> <a id="8338" class="Symbol">(</a><a id="8339" href="Chapter.Fun.RedBlackTree.html#3359" class="InductiveConstructor">red</a> <a id="8343" href="Chapter.Fun.RedBlackTree.html#8343" class="Bound">t</a><a id="8344" class="Symbol">)</a> <a id="8346" class="Symbol">=</a> <a id="8348" href="Chapter.Fun.RedBlackTree.html#8207" class="Function">⌈depthR⌉</a> <a id="8357" href="Chapter.Fun.RedBlackTree.html#8343" class="Bound">t</a>
<a id="8359" href="Chapter.Fun.RedBlackTree.html#8139" class="Function">⌈depth*⌉</a> <a id="8368" class="Symbol">(</a><a id="8369" href="Chapter.Fun.RedBlackTree.html#3408" class="InductiveConstructor">black</a> <a id="8375" href="Chapter.Fun.RedBlackTree.html#8375" class="Bound">t</a><a id="8376" class="Symbol">)</a> <a id="8378" class="Symbol">=</a> <a id="8380" href="Library.LessThan.html#987" class="Function">le-succ-r</a> <a id="8390" class="Symbol">(</a><a id="8391" href="Chapter.Fun.RedBlackTree.html#8270" class="Function">⌈depthB⌉</a> <a id="8400" href="Chapter.Fun.RedBlackTree.html#8375" class="Bound">t</a><a id="8401" class="Symbol">)</a>

<a id="8404" href="Chapter.Fun.RedBlackTree.html#8207" class="Function">⌈depthR⌉</a> <a id="8413" class="Symbol">{</a><a id="8414" href="Chapter.Fun.RedBlackTree.html#8414" class="Bound">n</a><a id="8415" class="Symbol">}</a> <a id="8417" class="Symbol">(</a><a id="8418" href="Chapter.Fun.RedBlackTree.html#2741" class="InductiveConstructor">node</a> <a id="8423" class="Symbol">_</a> <a id="8425" href="Chapter.Fun.RedBlackTree.html#8425" class="Bound">l</a> <a id="8427" href="Chapter.Fun.RedBlackTree.html#8427" class="Bound">r</a><a id="8428" class="Symbol">)</a> <a id="8430" class="Symbol">=</a>
  <a id="8434" href="Library.LessThan.html#271" class="InductiveConstructor">le-succ</a> <a id="8442" class="Symbol">(</a><a id="8443" href="Library.LessThan.html#1842" class="Function">le-max</a> <a id="8450" class="Symbol">(</a><a id="8451" href="Chapter.Fun.RedBlackTree.html#8270" class="Function">⌈depthB⌉</a> <a id="8460" href="Chapter.Fun.RedBlackTree.html#8425" class="Bound">l</a><a id="8461" class="Symbol">)</a> <a id="8463" class="Symbol">(</a><a id="8464" href="Chapter.Fun.RedBlackTree.html#8270" class="Function">⌈depthB⌉</a> <a id="8473" href="Chapter.Fun.RedBlackTree.html#8427" class="Bound">r</a><a id="8474" class="Symbol">))</a>

<a id="8478" href="Chapter.Fun.RedBlackTree.html#8270" class="Function">⌈depthB⌉</a> <a id="8487" href="Chapter.Fun.RedBlackTree.html#3107" class="InductiveConstructor">leaf</a> <a id="8492" class="Symbol">=</a> <a id="8494" href="Library.LessThan.html#239" class="InductiveConstructor">le-zero</a>
<a id="8502" href="Chapter.Fun.RedBlackTree.html#8270" class="Function">⌈depthB⌉</a> <a id="8511" class="Symbol">{</a><a id="8512" href="Library.Nat.html#59" class="InductiveConstructor">succ</a> <a id="8517" href="Chapter.Fun.RedBlackTree.html#8517" class="Bound">n</a><a id="8518" class="Symbol">}</a> <a id="8520" class="Symbol">(</a><a id="8521" href="Chapter.Fun.RedBlackTree.html#3128" class="InductiveConstructor">node</a> <a id="8526" class="Symbol">_</a> <a id="8528" href="Chapter.Fun.RedBlackTree.html#8528" class="Bound">l</a> <a id="8530" href="Chapter.Fun.RedBlackTree.html#8530" class="Bound">r</a><a id="8531" class="Symbol">)</a> <a id="8533" class="Symbol">=</a>
  <a id="8537" href="Library.LessThan.Reasoning.html#201" class="Function Operator">begin</a>
    <a id="8547" href="Library.Nat.html#59" class="InductiveConstructor">succ</a> <a id="8552" class="Symbol">(</a><a id="8553" href="Library.Nat.html#508" class="Function">max</a> <a id="8557" class="Symbol">(</a><a id="8558" href="Chapter.Fun.RedBlackTree.html#7843" class="Function">depth*</a> <a id="8565" href="Chapter.Fun.RedBlackTree.html#8528" class="Bound">l</a><a id="8566" class="Symbol">)</a> <a id="8568" class="Symbol">(</a><a id="8569" href="Chapter.Fun.RedBlackTree.html#7843" class="Function">depth*</a> <a id="8576" href="Chapter.Fun.RedBlackTree.html#8530" class="Bound">r</a><a id="8577" class="Symbol">))</a> <a id="8580" href="Library.LessThan.Reasoning.html#377" class="Function Operator">&lt;=⟨</a> <a id="8584" href="Library.LessThan.html#271" class="InductiveConstructor">le-succ</a> <a id="8592" class="Symbol">(</a><a id="8593" href="Library.LessThan.html#1842" class="Function">le-max</a> <a id="8600" class="Symbol">(</a><a id="8601" href="Chapter.Fun.RedBlackTree.html#8139" class="Function">⌈depth*⌉</a> <a id="8610" href="Chapter.Fun.RedBlackTree.html#8528" class="Bound">l</a><a id="8611" class="Symbol">)</a> <a id="8613" class="Symbol">(</a><a id="8614" href="Chapter.Fun.RedBlackTree.html#8139" class="Function">⌈depth*⌉</a> <a id="8623" href="Chapter.Fun.RedBlackTree.html#8530" class="Bound">r</a><a id="8624" class="Symbol">))</a> <a id="8627" href="Library.LessThan.Reasoning.html#377" class="Function Operator">⟩</a>
    <a id="8633" href="Library.Nat.html#59" class="InductiveConstructor">succ</a> <a id="8638" class="Symbol">(</a><a id="8639" href="Library.Nat.html#59" class="InductiveConstructor">succ</a> <a id="8644" class="Symbol">(</a><a id="8645" class="Number">2</a> <a id="8647" href="Library.Nat.html#293" class="Function Operator">*</a> <a id="8649" href="Chapter.Fun.RedBlackTree.html#8517" class="Bound">n</a><a id="8650" class="Symbol">))</a>              <a id="8666" href="Library.LessThan.Reasoning.html#297" class="Function Operator">==⟨</a> <a id="8670" href="Library.Equality.html#125" class="InductiveConstructor">refl</a> <a id="8675" href="Library.LessThan.Reasoning.html#297" class="Function Operator">⟩</a>
    <a id="8681" href="Library.Nat.html#59" class="InductiveConstructor">succ</a> <a id="8686" class="Symbol">(</a><a id="8687" href="Library.Nat.html#59" class="InductiveConstructor">succ</a> <a id="8692" class="Symbol">(</a><a id="8693" href="Chapter.Fun.RedBlackTree.html#8517" class="Bound">n</a> <a id="8695" href="Library.Nat.html#145" class="Function Operator">+</a> <a id="8697" class="Symbol">(</a><a id="8698" href="Chapter.Fun.RedBlackTree.html#8517" class="Bound">n</a> <a id="8700" href="Library.Nat.html#145" class="Function Operator">+</a> <a id="8702" class="Number">0</a><a id="8703" class="Symbol">)))</a>        <a id="8714" href="Library.LessThan.Reasoning.html#297" class="Function Operator">==⟨</a> <a id="8718" href="Library.Equality.html#373" class="Function">cong</a> <a id="8723" href="Library.Nat.html#59" class="InductiveConstructor">succ</a> <a id="8728" class="Symbol">(</a><a id="8729" href="Library.Nat.Properties.html#370" class="Function">+-succ</a> <a id="8736" href="Chapter.Fun.RedBlackTree.html#8517" class="Bound">n</a> <a id="8738" class="Symbol">(</a><a id="8739" href="Chapter.Fun.RedBlackTree.html#8517" class="Bound">n</a> <a id="8741" href="Library.Nat.html#145" class="Function Operator">+</a> <a id="8743" class="Number">0</a><a id="8744" class="Symbol">))</a> <a id="8747" href="Library.LessThan.Reasoning.html#297" class="Function Operator">⟩</a>
    <a id="8753" href="Library.Nat.html#59" class="InductiveConstructor">succ</a> <a id="8758" class="Symbol">(</a><a id="8759" href="Chapter.Fun.RedBlackTree.html#8517" class="Bound">n</a> <a id="8761" href="Library.Nat.html#145" class="Function Operator">+</a> <a id="8763" href="Library.Nat.html#59" class="InductiveConstructor">succ</a> <a id="8768" class="Symbol">(</a><a id="8769" href="Chapter.Fun.RedBlackTree.html#8517" class="Bound">n</a> <a id="8771" href="Library.Nat.html#145" class="Function Operator">+</a> <a id="8773" class="Number">0</a><a id="8774" class="Symbol">))</a>
  <a id="8779" href="Library.LessThan.Reasoning.html#254" class="Function Operator">end</a>
</pre>

  </div>
  <ul class="menu">
  <li><a href="Main.html">‹ Table of contents</a></li>
  <li><a href="Main.html">Table of contents ›</a></li>
</ul>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>
  <div class="wrapper">
    <!-- <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"> -->
    <!--   <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png"/> -->
    <!-- </a> -->
    2022-2023
    <a href="https://boystrange.github.io">Luca Padovani</a>
    and <a href="http://www.di.unito.it/~deligu/">Ugo de'Liguoro</a>.
    Page generated on 20 Sep 2023.
  </div>
</footer>
</body>

</html>
